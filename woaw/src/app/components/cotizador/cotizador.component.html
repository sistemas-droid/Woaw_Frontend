<!-- Si el vehículo no es elegible -->
<div *ngIf="!edadValida" class="alerta-edad">
  Este vehículo no es elegible para <strong>crédito</strong>, solo aplica pago de contado
  (<strong>Efectivo</strong>, <strong>transferencia</strong>, <strong>depósito bancario</strong>).
</div>

<!-- Cotizador -->
<ion-grid *ngIf="edadValida" class="cotizador-container">
  <h2>Consigue tu crédito</h2>

  <ion-row class="steps-row">
    <!-- PASO 1: ENGANCHE -->
    <ion-col size="12" size-md="4" class="step step-1">
      <div class="step-header">
        <div class="step-number">1</div>
        <div>
          <p class="step-title">Enganche</p>
          <small class="step-subtitle">
            A partir de {{ engancheMinimoPercent }}%
          </small>
        </div>
      </div>

      <div class="input-enganche-wrapper">
        <span>$</span>
        <input type="number" [value]="enganche" (input)="onEngancheManualChange($event)" [min]="engancheMinimo"
          [max]="engancheMaximo" step="100" />
      </div>

      <div *ngIf="mensajeErrorEnganche" class="mensaje-error">
        {{ mensajeErrorEnganche }}
      </div>
    </ion-col>

    <!-- PASO 2: PLAZO -->
    <ion-col size="12" size-md="4" class="step step-2" *ngIf="!mensajeErrorEnganche">
      <div class="step-header">
        <div class="step-number">2</div>
        <div>
          <p class="step-title">Plazo</p>
          <small class="step-subtitle">Meses</small>
        </div>
      </div>

      <div class="opciones">
        <label class="opcion" *ngFor="let m of plazosDisponibles">
          <input type="radio" name="plazo" [value]="m" [checked]="plazo === m" (change)="onPlazoChange(m)" />
          <span>{{ m }}</span>
        </label>
      </div>
    </ion-col>

    <!-- PASO 3: MENSUALIDAD -->
    <ion-col size="12" size-md="4" class="step step-3" *ngIf="!mensajeErrorEnganche">
      <div class="step-header">
        <div class="step-number">3</div>
        <div>
          <p class="step-title">Mensualidad desde:</p>
        </div>
      </div>

      <div class="resultado-mensualidad">
        <div class="monto">
          ${{ calcularMensualidad(plazo) | number: '1.0-0' }}
          <span>/ mes</span>
        </div>
        <div class="tasa">
          <span class="link-plazos">
          Tasa: {{ getTasa(plazo) | percent: '1.2-2' }}
        </span>
        </div>
      </div>
    </ion-col>
  </ion-row>

  <button [disabled]="mensajeErrorEnganche" class="btn-solicitar" (click)="enviarCredito()">
    Solicitar crédito ahora
  </button>

  <p class="nota">
    Simulación de crédito. El costo del seguro <strong>varía por vehículo</strong>.
    Solicita tu cotización en <strong>PDF</strong> para conocer el monto exacto.
  </p>
</ion-grid>