<app-spinner *ngIf="mostrar_spinnet"></app-spinner>

<ion-header [translucent]="true">
  <ion-toolbar class="custom-toolbar ios-toolbar">

    <!-- LEFT -->
    <ion-buttons slot="start">
      <div class="logo_content">

        <!-- Back (solo mﾃｳvil y cuando NO estﾃ｡s en home) + Logo -->
        <ion-button
          fill="clear"
          class="btn-back-logo"
          (click)="!estaEnHome && esDispositivoMovil ? regresar() : redirecion_logo()"
        >
          <ion-icon
            name="chevron-back-outline"
            class="icon-back"
            *ngIf="!estaEnHome && esDispositivoMovil && !mostrarBuscador"
          ></ion-icon>

          <img
            src="/assets/icon/logo2.png"
            loading="lazy"
            alt="WOAW"
            class="logo"
          />
        </ion-button>

        <!-- Botﾃｳn lupa para mostrar buscador (Mﾃ天IL) -->
        <ion-button
          fill="clear"
          class="btn-buscar"
          *ngIf="!mostrarBuscador && esDispositivoMovil"
          (click)="mostrarBuscador = true"
        >
          <ion-icon name="search-outline"></ion-icon>
        </ion-button>

        <!-- Botﾃｳn cerrar buscador (Mﾃ天IL) -->
        <ion-button
          fill="clear"
          class="btn-buscar"
          *ngIf="mostrarBuscador && esDispositivoMovil"
          (click)="cerrarBuscador()"
        >
          <ion-icon name="close-outline"></ion-icon>
        </ion-button>
      </div>

      <!-- Searchbar DESKTOP (solo cuando NO estﾃ｡s en home) -->
      <div class="buscador-container" *ngIf="!estaEnHome && !esDispositivoMovil">
        <ion-searchbar
          [(ngModel)]="terminoBusqueda"
          (ionInput)="onInputChange($event)"
          (keyup.enter)="irABusqueda(terminoBusqueda)"
          placeholder="Busca por marca, modelo o aﾃｱo"
          animated="true"
        ></ion-searchbar>
      </div>

      <!-- Searchbar Mﾃ天IL desplegable (cuando mostrarBuscador = true) -->
      <div
        class="buscador-container buscador-container--movil"
        *ngIf="mostrarBuscador && esDispositivoMovil"
      >
        <ion-searchbar
          [(ngModel)]="terminoBusqueda"
          (ionInput)="onInputChange($event)"
          (keyup.enter)="irABusqueda(terminoBusqueda)"
          placeholder="Busca por marca, modelo o aﾃｱo"
          animated="true"
        ></ion-searchbar>
      </div>
    </ion-buttons>

    <!-- RIGHT -->
    <ion-buttons slot="end">

      <!-- NAV DESKTOP -->
      <ng-container *ngIf="!esDispositivoMovil">

        <ion-button fill="clear" [ngClass]="{ 'activo': isActive('home') }" (click)="redirecion('home')">
          inicio
        </ion-button>

        <ion-button
          fill="clear"
          (click)="abrirPopover('Autos')"
          [ngClass]="{ 'activo': isActive('menu-vehiculos/autos') }"
        >
          Vehiculos
        </ion-button>

        <ion-button fill="clear" [ngClass]="{ 'activo': isActive('m-nuevos') }" (click)="redirecion('m-nuevos')">
          Motos
        </ion-button>

        <ion-button fill="clear" [ngClass]="{ 'activo': isActive('camiones/todos') }" (click)="redirecion('camiones/todos')">
          Camiones
        </ion-button>

        <ion-button fill="clear" [ngClass]="{ 'activo': isActive('arrendamiento') }" (click)="redirecion('arrendamiento')">
          Arrendamiento
        </ion-button>

        <ion-button fill="clear" [ngClass]="{ 'activo': isActive('seguros/disponibles') }" (click)="redirecion('seguros/disponibles')">
          Seguros de autos
        </ion-button>

        <ion-button fill="clear" [ngClass]="{ 'activo': isActive('conocenos') }" (click)="redirecion('conocenos')">
          Nosotros
        </ion-button>

        <ion-button
          fill="clear"
          [ngClass]="{ 'activo': isActive('inicio') }"
          (click)="redirecion('inicio')"
          *ngIf="!isLoggedIn"
        >
          Iniciar sesiﾃｳn
        </ion-button>

        <button
          class="btn-vender"
          [ngClass]="{ 'activo-btn-new': isActive('new-car') }"
          (click)="redirecion('new-car')"
          *ngIf="!esDispositivoMovil"
        >
          <ion-icon name="add-outline"></ion-icon>
          Publicar
        </button>

        <!-- USUARIO -->
        <div class="usuario-info" *ngIf="isLoggedIn" (click)="abrirModalPerfil()">
          <img
            *ngIf="!esDispositivoMovil"
            src="assets/icon/mexico.png"
            alt="MX"
            class="icono-bandera"
          />
          <div class="contenedor-nombre">
            <ng-container *ngIf="fotoPerfil; else iconoDefault">
              <img
                [src]="fotoPerfil"
                alt="Foto de perfil"
                width="20"
                height="20"
                class="avatar"
                referrerpolicy="no-referrer"
                (error)="fotoPerfil = null"
              />
            </ng-container>
            <ng-template #iconoDefault>
              <ion-icon name="person-outline" class="icono-user"></ion-icon>
            </ng-template>
            <span class="nombre-usuario">{{ usuario }}</span>
          </div>
        </div>

      </ng-container>
      <!-- /NAV DESKTOP -->

      <!-- ICONOS Mﾃ天IL -->
      <!-- 沐･ OJO: aquﾃｭ estﾃ｡ la magia: se ocultan cuando mostrarBuscador=true -->
      <ng-container *ngIf="esDispositivoMovil && !mostrarBuscador">

        <ion-button
          fill="clear"
          class="stack"
          [ngClass]="{ 'activo': isActive('favoritos') }"
          (click)="redirecion('favoritos')"
          *ngIf="isLoggedIn"
        >
          <span class="vcol">
            <ion-icon name="heart-outline"></ion-icon>
            <span class="label">Favoritos</span>
          </span>
        </ion-button>

        <ion-button
          fill="clear"
          class="stack"
          [ngClass]="{ 'activo': isActive('m-nuevos') }"
          (click)="redirecion('m-nuevos')"
        >
          <span class="vcol">
            <ion-icon name="bicycle-outline"></ion-icon>
            <span class="label">Motos</span>
          </span>
        </ion-button>

        <ion-button
          fill="clear"
          class="stack"
          [ngClass]="{ 'activo': isActive('camiones/todos') }"
          (click)="redirecion('camiones/todos')"
        >
          <span class="vcol">
            <ion-icon name="bus-outline"></ion-icon>
            <span class="label">Camiones</span>
          </span>
        </ion-button>

        <ion-button fill="clear" class="stack" (click)="openMenu()">
          <span class="vcol">
            <ion-icon name="menu-outline"></ion-icon>
            <span class="label">Menﾃｺ</span>
          </span>
        </ion-button>

      </ng-container>
      <!-- /ICONOS Mﾃ天IL -->

    </ion-buttons>
  </ion-toolbar>
</ion-header>