<div class="popover-wrap">
  <!-- fila superior: buscador + botón X -->
  <div class="top-row">
    <ion-searchbar class="searchbar-soft" placeholder="Buscar..." [debounce]="150" [value]="query"
      (ionInput)="onSearchChange($event)" (ionClear)="onClear()">
    </ion-searchbar>

    <!-- botón X (quitar filtro) -->
    <button class="icon-clear" (click)="seleccionar({ quitar: true })" title="Quitar filtro" aria-label="Quitar filtro">
      <ion-icon name="close-outline"></ion-icon>
    </button>
  </div>

  <div class="divider"></div>

  <div class="contenedor-scroll-marcas">
    <ion-list>
      <ion-item *ngFor="let opcion of opcionesFiltradas; trackBy: trackByKey" (click)="seleccionar(opcion)">

        <ng-container *ngIf="!opcion.quitar; else quitar">

          <!-- Dot de color -->
          <div *ngIf="tipo === 'color'" class="color-dot"
            [ngStyle]="{ 'background-color': obtenerColorHex(opcion.label) }">
          </div>

          <!-- Logo de marca -->
          <img *ngIf="tipo === 'marca' && opcion.imageUrl" [src]="opcion.imageUrl" alt="" class="logo-marca"
            (error)="ocultarImagen($event)" />

          <!-- ✅ SOLO ICONO para tipoVehiculoGeneral -->
          <ng-container *ngIf="tipo === 'tipoVehiculoGeneral'; else textoNormal">
            <ion-icon class="vehiculo-icon" [name]="getVehiculoIcon(opcion)">
            </ion-icon>
          </ng-container>

          <!-- Texto normal para el resto -->
          <ng-template #textoNormal>
            <ion-label>
              {{ getOpcionLabel(opcion) }}
            </ion-label>
          </ng-template>

        </ng-container>

        <ng-template #quitar>
          <ion-label color="danger">
            <strong>Quitar filtro</strong>
          </ion-label>
        </ng-template>

      </ion-item>

      <ion-item *ngIf="opcionesFiltradas.length === 0">
        <ion-label>Sin resultados</ion-label>
      </ion-item>
    </ion-list>
  </div>
</div>