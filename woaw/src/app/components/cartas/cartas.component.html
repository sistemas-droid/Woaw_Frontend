<div class="card-ios" (click)="onCardClick(auto, $event)">

  <!-- Badge tipoVenta -->
  <div class="badge-tipo" *ngIf="auto?.tipoVenta">
    {{ auto.tipoVenta }}
  </div>

  <!-- ✅ TOP-RIGHT: SOLO favoritos cuando NO es mis vehiculos -->
  <!-- FAVORITOS: delete -->
  <button
    class="fav-btn delete"
    *ngIf="!esMisVehiculos && ubicacion === 'favoritos'"
    (click)="eliminarDeFavoritos(auto._id); $event.stopPropagation()">
    <ion-icon name="trash-outline"></ion-icon>
  </button>

  <!-- CATÁLOGO NORMAL: favorito -->
  <button
    class="fav-btn"
    *ngIf="!esMisVehiculos && ubicacion !== 'favoritos'"
    (click)="agregarAFavoritos(auto._id); $event.stopPropagation()">
    <ion-icon [name]="autosFavoritosIds.has(auto._id) ? 'heart' : 'heart-outline'"></ion-icon>
  </button>

  <!-- Imagen -->
  <div class="img-box">
    <!-- overlay vendido -->
    <div class="overlay" *ngIf="auto?.estadoVehiculo === 'vendido'"></div>

    <ion-img
      [src]="getImagen(auto)"
      (ionImgDidLoad)="markCarLoaded(auto._id)"
      (ionError)="onImgError($event, auto); markCarLoaded(auto._id)"
      [class.img-hidden]="!carsLoaded[auto._id]">
    </ion-img>

    <!-- loader -->
    <div class="loader" *ngIf="!carsLoaded[auto._id]">
      <div class="spinner"></div>
      <span>Cargando...</span>
    </div>
  </div>

  <!-- Info -->
  <div class="info-box">
    <h4 class="title">
      {{ auto.marca }} • {{ auto.modelo }} {{ auto.anio }}
    </h4>

    <!-- Precio -->
    <p class="price" *ngIf="!FormatoPrecios">
      {{
        auto?.version?.length > 1
          ? ('Desde ' + (obtenerPrecioMinimo(auto.version) | currency:'MXN':'symbol':'1.0-0'))
          : (auto?.version?.[0]?.Precio | currency:'MXN':'symbol':'1.0-0')
      }}
    </p>

    <p class="price" *ngIf="FormatoPrecios">
      {{ auto?.precio?.porDia | currency:'MXN':'symbol':'1.0-0' }}
    </p>

    <!-- ✅ EN MIS VEHÍCULOS: botón centrado (en lugar de specs) -->
    <div class="estado-center" *ngIf="esMisVehiculos">
      <button
        class="estado-btn-inline"
        [ngClass]="{
          'disponible': auto?.estadoVehiculo === 'disponible',
          'vendido': auto?.estadoVehiculo === 'vendido'
        }"
        (click)="toggleEstado(auto, $event)">
        <ion-icon
          [name]="auto?.estadoVehiculo === 'disponible' ? 'toggle-outline' : 'toggle-sharp'"
          class="icono-switch">
        </ion-icon>
        {{ auto?.estadoVehiculo | titlecase }}
      </button>
    </div>

    <!-- ✅ EN CATÁLOGO NORMAL: specs como siempre -->
    <div class="specs" *ngIf="!esMisVehiculos">
      <span *ngIf="auto.kilometraje">{{ auto.kilometraje | number }} km</span>
      <span *ngIf="auto.transmision">{{ auto.transmision }}</span>
      <span *ngIf="auto.ubicacion?.ciudad">{{ auto.ubicacion.ciudad }}</span>
    </div>
  </div>

</div>