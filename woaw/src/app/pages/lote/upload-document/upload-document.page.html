<app-navbar></app-navbar>

<ion-content [fullscreen]="true">
  <div class="ion-padding">

    <!-- TÃ­tulo -->
    <div class="ion-text-center ion-margin-bottom page-title-box">
      <h1 class="ion-text-bold titulo-woaw">{{ nombreDocumentoMostrar }}</h1>
      <p class="ion-text-muted subtitulo-woaw">
        Subir documento para el lote: <strong>{{ nombreLote }}</strong>
      </p>
    </div>

    <!-- ðŸš¨ BLOQUEADO SI ESTÃ APROBADO -->
    <ion-card *ngIf="documentoActualEstado === 'aprobado'" class="upload-card ion-margin-bottom">
      <ion-card-content class="ion-text-center">
        <ion-icon name="checkmark-circle" color="success" style="font-size:40px;"></ion-icon>
        <p class="ion-margin-top ion-text-bold">
          Este documento ya fue aprobado
        </p>
        <p class="ion-text-muted">
          Si necesitas hacer cambios, contacta a un administrador.
        </p>
      </ion-card-content>
    </ion-card>

    <ion-card class="upload-card">
      <ion-card-content>

        <!-- Campo de archivo -->
        <ion-item lines="none" class="file-item">

          <ion-label class="file-label">Seleccionar archivo</ion-label>

          <!-- Link documento actual -->
          <div *ngIf="documentoActualUrl && documentoActualNombre" class="file-link-wrapper">
            <span class="file-link" (click)="abrirDocumento()">
              {{ documentoActualNombre }}
            </span>

            <!-- âŒ Solo si NO estÃ¡ aprobado -->
            <button *ngIf="documentoActualEstado !== 'aprobado'" type="button" class="file-delete-btn"
              (click)="eliminarDocumento($event)">
              âœ•
            </button>
          </div>

          <!-- Input file -->
          <input type="file" accept=".pdf,.jpg,.jpeg,.png" [disabled]="documentoActualEstado === 'aprobado'"
            (change)="onFileSelected($event)" />

        </ion-item>

        <!-- Mobile link -->
        <div *ngIf="documentoActualUrl && documentoActualNombre" class="file-link-mobile">
          <span class="file-link" (click)="abrirDocumento()">
            {{ documentoActualNombre }}
          </span>

          <button *ngIf="documentoActualEstado !== 'aprobado'" type="button" class="file-delete-btn"
            (click)="eliminarDocumento($event)">
            âœ•
          </button>
        </div>

        <!-- Archivo seleccionado -->
        <div class="ion-text-center ion-margin-top" *ngIf="archivoSeleccionado">
          <p class="archivo-info">
            <strong>Archivo seleccionado:</strong> {{ archivoSeleccionado.name }}
          </p>
        </div>

        <!-- Botones -->
        <div class="botones-desktop">
          <ion-button expand="block" class="btn-subir"
            [disabled]="!archivoSeleccionado || documentoActualEstado === 'aprobado'" (click)="subirArchivo()">
            SUBIR DOCUMENTO
          </ion-button>

          <ion-button expand="block" fill="outline" class="btn-cancelar"
            (click)="router.navigateByUrl('/lote/documentos/' + nombreLote + '/' + idLote)">
            CANCELAR
          </ion-button>
        </div>

      </ion-card-content>
    </ion-card>

  </div>

  <app-footer></app-footer>
</ion-content>