"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4961],{4961:(z,m,c)=>{c.r(m),c.d(m,{NuevosPageModule:()=>E});var f=c(2881),A=c(9417),p=c(7343),h=c(9870),d=c(467),N=c(7051),v=c(2571),t=c(1360),F=c(5806),y=c(9557),_=c(2381),b=c(9847),x=c(1969),P=c(4371),M=c(7677),C=c(8857);const I=["pageContent"];function O(n,l){if(1&n&&t.nrm(0,"app-spinner",14),2&n){const s=t.XpG();t.Y8G("tipo",s.tipo_spinner)("text",s.texto_spinner)("sub_text",s.textoSub_spinner)}}function j(n,l){if(1&n){const s=t.RV6();t.j41(0,"app-menu",15),t.bIt("mostrarOpciones",function(e){t.eBV(s);const i=t.XpG();return t.Njj(i.mostrarOpciones(e.event,e.tipo))})("limpiarFiltros",function(){t.eBV(s);const e=t.XpG();return t.Njj(e.resetearFiltros())}),t.k0s()}if(2&n){const s=t.XpG();t.Y8G("filtros",s.filtros)("filtrosAplicados",s.filtrosAplicados)}}function k(n,l){1&n&&(t.j41(0,"div",16),t.nrm(1,"ion-icon",17),t.j41(2,"p"),t.EFF(3,"No se encontraron autos para esta secci\xf3n."),t.k0s()())}function G(n,l){if(1&n){const s=t.RV6();t.qex(0),t.j41(1,"app-cartas",19),t.bIt("refrescarAutos",function(e){t.eBV(s);const i=t.XpG(2);return t.Njj(i.handleRefrescarAutos(e))}),t.k0s(),t.bVm()}if(2&n){const s=l.$implicit,o=t.XpG(2);t.R7$(),t.Y8G("auto",s)("autosFavoritosIds",o.autosFavoritosIds)("ubicacion","nuevos")("esMio",o.idsMisAutos.includes(s._id))}}function R(n,l){if(1&n&&(t.qex(0),t.DNE(1,G,2,4,"ng-container",18),t.bVm()),2&n){const s=t.XpG();t.R7$(),t.Y8G("ngForOf",s.autosPaginados)}}function w(n,l){if(1&n){const s=t.RV6();t.j41(0,"button",26),t.bIt("click",function(){t.eBV(s);const e=t.XpG().$implicit,i=t.XpG(2);return t.Njj(i.cambiarPagina(e))}),t.EFF(1),t.k0s()}if(2&n){const s=t.XpG().$implicit,o=t.XpG(2);t.AVh("activa",o.paginaActual===s),t.R7$(),t.SpI(" ",s," ")}}function S(n,l){1&n&&(t.j41(0,"span",27),t.EFF(1,"..."),t.k0s())}function $(n,l){if(1&n&&(t.qex(0),t.DNE(1,w,2,3,"button",24)(2,S,2,0,"span",25),t.bVm()),2&n){const s=l.$implicit,o=t.XpG(2);t.R7$(),t.Y8G("ngIf",o.esNumero(s)),t.R7$(),t.Y8G("ngIf",!o.esNumero(s))}}function D(n,l){if(1&n){const s=t.RV6();t.j41(0,"div",20)(1,"div",21)(2,"div",22)(3,"button",23),t.bIt("click",function(){t.eBV(s);const e=t.XpG();return t.Njj(e.cambiarPagina(e.paginaActual-1))}),t.EFF(4," \u2039 "),t.k0s(),t.DNE(5,$,3,2,"ng-container",18),t.j41(6,"button",23),t.bIt("click",function(){t.eBV(s);const e=t.XpG();return t.Njj(e.cambiarPagina(e.paginaActual+1))}),t.EFF(7," \u203a "),t.k0s()()()()}if(2&n){const s=t.XpG();t.R7$(3),t.Y8G("disabled",1===s.paginaActual),t.R7$(2),t.Y8G("ngForOf",s.paginasReducidas),t.R7$(),t.Y8G("disabled",s.paginaActual===s.totalPaginas)}}const T=[{path:"",component:(()=>{var n;class l{constructor(o,e,i,a,r,u,g){this.menu=o,this.generalService=e,this.popoverCtrl=i,this.carsService=a,this.modalCtrl=r,this.router=u,this.route=g,this.esDispositivoMovil=!1,this.autosStorage=[],this.autosFavoritos=[],this.filtros=[{label:"Precio",tipo:"precio"},{label:"Marca",tipo:"marca"}],this.mostrarInfo=!1,this.filtrosAplicados={precio:null,anio:null,color:null,marca:null},this.totalAutos=0,this.autosFiltrados=[],this.isLoggedIn=!1,this.MyRole=null,this.autosFavoritosIds=new Set,this.ordenActivo=null,this.idsMisAutos=[],this.paginaActual=1,this.totalPaginas=1,this.paginas=[],this.autosPaginados=[],this.dispositivo="",this.showSplash=!0,this.mostrar_spinner=!1,this.tipo_spinner=0,this.texto_spinner="Cargando...",this.textoSub_spinner="Espere un momento"}ngOnInit(){this.generalService.dispositivo$.subscribe(o=>{this.esDispositivoMovil="telefono"===o||"tablet"===o}),this.getCarsNews(),this.generalService.tokenExistente$.subscribe(o=>{this.isLoggedIn=o}),this.generalService.tipoRol$.subscribe(o=>{this.MyRole=o}),this.generalService.valorGlobal$.subscribe(o=>{this.itemsPorPagina=o}),this.generalService.dispositivo$.subscribe(o=>{this.esDispositivoMovil="telefono"===o||"tablet"===o,this.dispositivo=o}),this.misAutos()}getCarsNews(){this.mostrar_spinner=!0,this.carsService.getCarsNews().subscribe({next:o=>{this.autosStorage=((null==o?void 0:o.coches)||[]).map(i=>{var a;const r=(null===(a=i.version)||void 0===a?void 0:a.map(Y=>Y.Precio))||[],u=Math.min(...r),g=Math.max(...r);return{...i,estadoVehiculo:i.estadoVehiculo||"disponible",imagen:i.imagenPrincipal||"/assets/default-car.webp",precioDesde:u,precioHasta:g}}),this.totalAutos=this.autosStorage.length,this.getCarsFavoritos(),this.calcularPaginacion(),this.mostrar_spinner=!1},error:o=>{var e;this.mostrar_spinner=!1;const i=(null==o||null===(e=o.error)||void 0===e?void 0:e.message)||"Ocurri\xf3 un error inesperado";this.generalService.alert("Error al guardar los datos",i)}})}getCarsFavoritos(){this.carsService.getCarsFavoritos().subscribe({next:o=>{const e=o.vehicles.map(i=>i.vehicleId);this.autosFavoritosIds=new Set(e),this.aplicarFiltros()},error:o=>{}})}ficha(o){var e=this;return(0,d.A)(function*(){e.router.navigate(["/ficha",o._id])})()}doRefresh(o){this.getCarsNews(),this.filtrosAplicados={},setTimeout(()=>{o.target.complete()},1500)}mostrarOpciones(o,e){var i=this;return(0,d.A)(function*(){const a=yield i.popoverCtrl.create({component:N.s,event:o,translucent:!0,componentProps:{tipo:e}});yield a.present();const{data:r}=yield a.onDidDismiss();i.filtrosAplicados[e]=null===r?null:r,i.aplicarFiltros()})()}aplicarFiltros(){let o=[...this.autosStorage];const{precio:e,anio:i,color:a,marca:r}=this.filtrosAplicados;e&&(o=o.filter(u=>u.precioDesde>=e.rango[0]&&u.precioDesde<=e.rango[1])),null!=i&&i.anio&&(o=o.filter(u=>u.anio===i.anio)),a&&(o=o.filter(u=>{var g;return(null===(g=u.color)||void 0===g?void 0:g.toLowerCase())===a.label.toLowerCase()})),r&&(o=o.filter(u=>u.marca.toLowerCase()===r.label.toLowerCase())),this.autosFiltrados=o,this.totalPaginas=Math.ceil(o.length/this.itemsPorPagina),this.paginas=Array.from({length:this.totalPaginas},(u,g)=>g+1),this.autosPaginados=o.slice(0,this.itemsPorPagina)}resetearFiltros(){this.filtrosAplicados={},this.aplicarFiltros()}calcularPaginacion(){this.totalPaginas=Math.ceil(this.autosStorage.length/this.itemsPorPagina),this.paginas=Array.from({length:this.totalPaginas},(o,e)=>e+1),this.mostrarPagina(this.paginaActual)}mostrarPagina(o){this.paginaActual=o;const e=this.autosFiltrados.length?this.autosFiltrados:[...this.autosStorage],i=(o-1)*this.itemsPorPagina;this.autosPaginados=e.slice(i,i+this.itemsPorPagina)}cambiarPagina(o){this.mostrarPagina(o),setTimeout(()=>{this.content.scrollToTop(400)},100)}agregarAFavoritos(o){var e=this;return(0,d.A)(function*(){if(!e.isLoggedIn)return e.router.navigate(["/inicio"]),void e.generalService.alert("Inicia sesi\xf3n","Debes iniciar sesi\xf3n para poder agregar este veh\xedculo a tus favoritos.","info");var i;yield e.generalService.loading("Agregando a favoritos..."),e.carsService.agregarFavorito(o).subscribe({next:(i=(0,d.A)(function*(){e.getCarsNews(),yield e.generalService.loadingDismiss()}),function(){return i.apply(this,arguments)}),error:function(){var i=(0,d.A)(function*(a){var r;yield e.generalService.loadingDismiss();const u=(null===(r=a.error)||void 0===r?void 0:r.message)||"No se pudo agregar el auto a favoritos. Intenta m\xe1s tarde.";yield e.generalService.alert("Error",u,"danger")});return function(r){return i.apply(this,arguments)}}()})})()}handleRefrescarAutos(o){"nuevos"===o&&this.getCarsNews()}ordenarAutos(o){this.ordenActivo=o;const e=this.autosFiltrados.length?this.autosFiltrados:[...this.autosStorage];switch(o){case"precioAsc":e.sort((i,a)=>i.precioDesde-a.precioDesde);break;case"precioDesc":e.sort((i,a)=>a.precioDesde-i.precioDesde);break;default:e.sort((i,a)=>a.anio-i.anio)}this.autosFiltrados=e,this.totalPaginas=Math.ceil(e.length/this.itemsPorPagina),this.paginas=Array.from({length:this.totalPaginas},(i,a)=>a+1),this.autosPaginados=e.slice(0,this.itemsPorPagina)}misAutos(){var o=this;return(0,d.A)(function*(){o.isLoggedIn?o.carsService.misAutosId().subscribe({next:e=>{o.idsMisAutos=e&&Array.isArray(e.vehicleIds)&&e.vehicleIds.length>0?e.vehicleIds:[]},error:e=>{var i;const a=(null==e||null===(i=e.error)||void 0===i?void 0:i.message)||"Error al obtener tus veh\xedculos.";"No se encontraron veh\xedculos para este usuario"===a?o.idsMisAutos=[]:console.warn(a)}}):o.idsMisAutos=[]})()}esNumero(o){return"number"==typeof o}get paginasReducidas(){const o=this.totalPaginas,e=this.paginaActual;if(o<=2)return this.paginas;const a=[];a.push(1),e-1>2&&a.push("...");for(let r=Math.max(2,e-1);r<=Math.min(o-1,e+1);r++)a.push(r);return e+1<o-1&&a.push("..."),a.push(o),a}abrirModalArrendamiento(){var o=this;return(0,d.A)(function*(){let e;e="telefono"===o.dispositivo?yield o.modalCtrl.create({component:v.$,breakpoints:[0,.7,1],cssClass:"modal-perfil",initialBreakpoint:.7,handle:!0,backdropDismiss:!0,showBackdrop:!0}):yield o.modalCtrl.create({component:v.$,backdropDismiss:!0,showBackdrop:!0,cssClass:"modal-consentimiento"}),yield e.present()})()}}return(n=l).\u0275fac=function(o){return new(o||n)(t.rXU(p._t),t.rXU(F.O),t.rXU(p.IE),t.rXU(y.R),t.rXU(p.W3),t.rXU(_.Ix),t.rXU(_.nX))},n.\u0275cmp=t.VBU({type:n,selectors:[["app-nuevos"]],viewQuery:function(o,e){if(1&o&&t.GBs(I,5),2&o){let i;t.mGM(i=t.lsd())&&(e.content=i.first)}},standalone:!1,decls:16,vars:10,consts:[["pageContent",""],[1,"contenido-ios",3,"fullscreen"],["slot","fixed","pullFactor","0.4","pullMin","120","pullMax","200",3,"ionRefresh"],["pullingIcon","arrow-down-outline","refreshingSpinner","crescent","pullingText","Desliza para actualizar","refreshingText","Actualizando..."],[3,"ordenCambio","totalAutos","titulo"],[3,"tipo","text","sub_text",4,"ngIf"],[1,"contenedor-catalogo-ios"],["size","12","size-md","3"],[3,"filtros","filtrosAplicados","mostrarOpciones","limpiarFiltros",4,"ngIf"],["size","12","size-md","9"],[1,"catalogo-autos-ios"],["class","mensaje-vacio-ios",4,"ngIf"],[4,"ngIf"],["class","contenedor-paginacion-ios",4,"ngIf"],[3,"tipo","text","sub_text"],[3,"mostrarOpciones","limpiarFiltros","filtros","filtrosAplicados"],[1,"mensaje-vacio-ios"],["name","car-sport-outline",1,"icono-mensaje"],[4,"ngFor","ngForOf"],[3,"refrescarAutos","auto","autosFavoritosIds","ubicacion","esMio"],[1,"contenedor-paginacion-ios"],[1,"paginacion-scroll-ios"],[1,"paginacion-ios"],[1,"pagina-ios",3,"click","disabled"],["class","pagina-ios",3,"activa","click",4,"ngIf"],["class","ellipsis-ios",4,"ngIf"],[1,"pagina-ios",3,"click"],[1,"ellipsis-ios"]],template:function(o,e){if(1&o){const i=t.RV6();t.nrm(0,"app-navbar"),t.j41(1,"ion-content",1,0)(3,"ion-refresher",2),t.bIt("ionRefresh",function(r){return t.eBV(i),t.Njj(e.doRefresh(r))}),t.nrm(4,"ion-refresher-content",3),t.k0s(),t.j41(5,"app-acomodo",4),t.bIt("ordenCambio",function(r){return t.eBV(i),t.Njj(e.ordenarAutos(r))}),t.k0s(),t.DNE(6,O,1,3,"app-spinner",5),t.j41(7,"ion-grid",6)(8,"ion-row")(9,"ion-col",7),t.DNE(10,j,1,2,"app-menu",8),t.k0s(),t.j41(11,"ion-col",9)(12,"div",10),t.DNE(13,k,4,0,"div",11)(14,R,2,1,"ng-container",12),t.k0s(),t.DNE(15,D,8,3,"div",13),t.k0s()()()()}2&o&&(t.R7$(),t.Y8G("fullscreen",!0),t.R7$(4),t.Y8G("totalAutos",e.totalAutos)("titulo","Nuevos"),t.R7$(),t.Y8G("ngIf",e.mostrar_spinner),t.R7$(4),t.Y8G("ngIf",!e.mostrarInfo),t.R7$(2),t.AVh("sin-autos",!e.autosPaginados||0===e.autosPaginados.length),t.R7$(),t.Y8G("ngIf",!e.autosPaginados||0===e.autosPaginados.length),t.R7$(),t.Y8G("ngIf",e.autosPaginados&&e.autosPaginados.length>0),t.R7$(),t.Y8G("ngIf",e.totalPaginas>1))},dependencies:[f.Sq,f.bT,p.hU,p.W9,p.lO,p.iq,p.To,p.Ki,p.ln,b._,x.Z,P.a,M.E,C.t],styles:['@charset "UTF-8";.contenido-ios[_ngcontent-%COMP%]{--background: #f2f2f7;font-family:-apple-system,BlinkMacSystemFont,SF Pro Text,sans-serif}.header-ios[_ngcontent-%COMP%]{--background: rgba(249, 249, 249, .94);--border-color: rgba(0, 0, 0, .08);--color: #111827;backdrop-filter:blur(18px);-webkit-backdrop-filter:blur(18px);border-bottom:.33px solid var(--border-color);padding-inline:8px;min-height:52px}.btn-back-ios[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:4px;padding:4px 10px;border-radius:999px;border:none;background:#0000000a;color:#007aff;font-size:14px;font-weight:500;cursor:pointer}.btn-back-ios[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.btn-back-ios[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{transform:translateY(-.5px)}.btn-back-ios[_ngcontent-%COMP%]:active{background:#00000014}.logo-ios[_ngcontent-%COMP%]{height:22px;width:auto}.contenedor-catalogo-ios[_ngcontent-%COMP%]{max-width:1100px;width:100%;margin:0 auto;padding:0 12px 20px}.catalogo-autos-ios[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:14px;margin-top:14px;margin-bottom:20px}@media (max-width: 768px){.catalogo-autos-ios[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(155px,1fr));gap:10px}}@media (max-width: 540px){.catalogo-autos-ios[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr);gap:8px}}.catalogo-autos-ios[_ngcontent-%COMP%]   app-cartas[_ngcontent-%COMP%]{display:block}.catalogo-autos-ios.sin-autos[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;margin-top:0;margin-bottom:0;min-height:calc(100vh - 200px)}@media (max-width: 768px){.catalogo-autos-ios.sin-autos[_ngcontent-%COMP%]{min-height:calc(100vh - 180px)}}.mensaje-vacio-ios[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;color:#8e8e93;font-size:15px;margin-top:0}.mensaje-vacio-ios[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:60px;margin-bottom:10px;color:#b3b3b9}.mensaje-vacio-ios[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;max-width:320px;line-height:1.45;font-weight:500}.contenedor-paginacion-ios[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;margin-top:18px;padding-bottom:10px}.titulo-paginacion-ios[_ngcontent-%COMP%]{margin:0 0 6px;font-size:12px;font-weight:600;text-transform:uppercase;letter-spacing:.12em;color:#6b7280}.paginacion-scroll-ios[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center;overflow-x:auto;padding-bottom:4px;scrollbar-width:thin;scrollbar-color:rgba(148,163,184,.9) transparent}.paginacion-scroll-ios[_ngcontent-%COMP%]::-webkit-scrollbar{height:5px}.paginacion-scroll-ios[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#94a3b8e6;border-radius:999px}.paginacion-ios[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:6px;padding:5px 6px;border-radius:999px;background:#fffffff5;backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);box-shadow:0 10px 22px #0f172a29,0 0 0 .5px #ffffffe6}.pagina-ios[_ngcontent-%COMP%]{min-width:32px;height:32px;padding:0 10px;border-radius:999px;border:none;outline:none;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:13px;font-weight:600;color:#111827;background:transparent;transition:background .18s ease,color .18s ease,transform .16s ease,box-shadow .16s ease}.pagina-ios[_ngcontent-%COMP%]:disabled{opacity:.35;cursor:default}.pagina-ios[_ngcontent-%COMP%]:not(.activa):not(:disabled):hover{background:#94a3b82e;transform:translateY(-1px)}.pagina-ios.activa[_ngcontent-%COMP%]{background:#ff3b30;color:#fff;box-shadow:0 8px 18px #ff3b308c;transform:translateY(-1px)}.ellipsis-ios[_ngcontent-%COMP%]{padding:0 6px;font-size:14px;color:#9ca3af;font-weight:500}']}),l})()}];let X=(()=>{var n;class l{}return(n=l).\u0275fac=function(o){return new(o||n)},n.\u0275mod=t.$C({type:n}),n.\u0275inj=t.G2t({imports:[h.iI.forChild(T),h.iI]}),l})();var V=c(5473);let E=(()=>{var n;class l{}return(n=l).\u0275fac=function(o){return new(o||n)},n.\u0275mod=t.$C({type:n}),n.\u0275inj=t.G2t({imports:[f.MD,A.YN,p.bv,X,b._,x.Z,P.a,M.E,V.n,C.t]}),l})()}}]);