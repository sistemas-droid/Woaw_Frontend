"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4371],{1539:(E,P,l)=>{l.d(P,{o:()=>O});var m=l(2881),t=l(7343),v=l(9417),n=l(1360);function M(d,x){if(1&d){const h=n.RV6();n.j41(0,"button",12),n.bIt("click",function(){n.eBV(h);const a=n.XpG();return n.Njj(a.anterior())}),n.nrm(1,"ion-icon",13),n.k0s()}}function I(d,x){if(1&d){const h=n.RV6();n.j41(0,"button",14),n.bIt("click",function(){n.eBV(h);const a=n.XpG();return n.Njj(a.siguiente())}),n.nrm(1,"ion-icon",15),n.k0s()}}let O=(()=>{var d;class x{constructor(c){this.modalCtrl=c,this.imagenes=[],this.indice=0,this.actual="",this.touchStartX=0,this.esVertical=!0,this.anguloRotacion=0,this.estilosImagenRotada={}}ngOnInit(){this.actual=this.imagenes[this.indice]||"",this.analizarProporcion(this.actual)}siguiente(){this.indice<this.imagenes.length-1&&(this.indice++,this.actual=this.imagenes[this.indice],this.anguloRotacion=0,this.analizarProporcion(this.actual))}anterior(){this.indice>0&&(this.indice--,this.actual=this.imagenes[this.indice],this.anguloRotacion=0,this.analizarProporcion(this.actual))}cerrar(){this.modalCtrl.dismiss()}onTouchStart(c){this.touchStartX=c.changedTouches[0].clientX}onTouchEnd(c){const u=this.touchStartX-c.changedTouches[0].clientX;Math.abs(u)>50&&(u>0?this.siguiente():this.anterior())}rotarImagen(c){c.stopPropagation(),this.anguloRotacion=(this.anguloRotacion+90)%360,this.aplicarEstilosRotacion()}aplicarEstilosRotacion(){const c=this.anguloRotacion,a=window.innerWidth,u=window.innerHeight,g=c%180==0?Math.min(a/a,u/u):Math.min(a/u,u/a);this.estilosImagenRotada={transform:`rotate(${c}deg) scale(${g})`,transition:"transform 0.4s ease","transform-origin":"center center","max-width":"100%","max-height":"100%","object-fit":"contain",display:"block",margin:"auto"}}analizarProporcion(c){const a=new Image;a.onload=()=>{this.esVertical=a.height>a.width,this.aplicarEstilosRotacion()},a.src=c}}return(d=x).\u0275fac=function(c){return new(c||d)(n.rXU(t.W3))},d.\u0275cmp=n.VBU({type:d,selectors:[["app-imagenes-vehiculo"]],inputs:{imagenes:"imagenes",indice:"indice"},decls:14,vars:4,consts:[[1,"modal-ios",3,"click"],[1,"viewer-ios",3,"click","touchstart","touchend"],[1,"viewer-header-ios"],["type","button",1,"btn-header-ios",3,"click"],["src","assets/icon/girar.png","alt","Girar",1,"icon-girar-ios"],["type","button",1,"btn-header-ios","btn-close-ios",3,"click"],["name","close-outline"],[1,"viewer-main-ios"],["class","nav-ios nav-ios--left","type","button",3,"click",4,"ngIf"],[1,"contenedor-rotado-ios"],["alt","Foto veh\xedculo",1,"imagen-grande-ios",3,"src","ngStyle"],["class","nav-ios nav-ios--right","type","button",3,"click",4,"ngIf"],["type","button",1,"nav-ios","nav-ios--left",3,"click"],["name","chevron-back-outline"],["type","button",1,"nav-ios","nav-ios--right",3,"click"],["name","chevron-forward-outline"]],template:function(c,a){1&c&&(n.j41(0,"div",0),n.bIt("click",function(){return a.cerrar()}),n.j41(1,"div",1),n.bIt("click",function(g){return g.stopPropagation()})("touchstart",function(g){return a.onTouchStart(g)})("touchend",function(g){return a.onTouchEnd(g)}),n.j41(2,"div",2)(3,"button",3),n.bIt("click",function(g){return a.rotarImagen(g)}),n.nrm(4,"img",4),n.j41(5,"span"),n.EFF(6,"Girar"),n.k0s()(),n.j41(7,"button",5),n.bIt("click",function(){return a.cerrar()}),n.nrm(8,"ion-icon",6),n.k0s()(),n.j41(9,"div",7),n.DNE(10,M,2,0,"button",8),n.j41(11,"div",9),n.nrm(12,"img",10),n.k0s(),n.DNE(13,I,2,0,"button",11),n.k0s()()()),2&c&&(n.R7$(10),n.Y8G("ngIf",a.indice>0),n.R7$(2),n.Y8G("src",a.actual,n.B4B)("ngStyle",a.estilosImagenRotada),n.R7$(),n.Y8G("ngIf",a.indice<a.imagenes.length-1))},dependencies:[t.bv,t.iq,m.MD,m.bT,m.B3,v.X1],styles:['@charset "UTF-8";[_nghost-%COMP%]{--ink: #f9fafb;--muted: #9ca3af;--accent: #ef4444}.modal-ios[_ngcontent-%COMP%]{position:fixed;top:0;right:0;bottom:0;left:0;z-index:9999;display:flex;align-items:center;justify-content:center;background:#0f172adb;-webkit-backdrop-filter:blur(18px);backdrop-filter:blur(18px)}.viewer-ios[_ngcontent-%COMP%]{position:relative;width:100%;max-width:960px;height:calc(100vh - 40px);background:radial-gradient(circle at top,#020617 0,#020617 40%,#000);border-radius:24px;box-shadow:0 26px 60px #000000bf;overflow:hidden;display:flex;flex-direction:column;padding:10px 12px 16px;box-sizing:border-box}@media (max-width: 768px){.viewer-ios[_ngcontent-%COMP%]{max-width:100%;height:100vh;border-radius:0;padding:8px 6px 12px}}.viewer-header-ios[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:8px;padding:4px 2px 6px;z-index:10}.btn-header-ios[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:6px;padding:6px 12px;border-radius:999px;border:1px solid rgba(148,163,184,.6);background:#0f172ab3;color:var(--ink);font-size:12px;font-weight:500;cursor:pointer;-webkit-backdrop-filter:blur(16px);backdrop-filter:blur(16px);box-shadow:0 8px 20px #0000008c,0 0 0 .5px #0f172ae6;transition:transform .16s ease,background .16s ease,box-shadow .16s ease,border-color .16s ease}.btn-header-ios[_ngcontent-%COMP%]:active{transform:scale(.96);background:#0f172ae6;box-shadow:0 4px 14px #0009}.btn-header-ios[_ngcontent-%COMP%]   .icon-girar-ios[_ngcontent-%COMP%]{width:18px;height:18px;object-fit:contain;display:block}.btn-header-ios[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.btn-close-ios[_ngcontent-%COMP%]{padding-inline:8px;min-width:34px;justify-content:center}.viewer-main-ios[_ngcontent-%COMP%]{flex:1;position:relative;display:flex;align-items:center;justify-content:center}.contenedor-rotado-ios[_ngcontent-%COMP%]{max-width:100%;max-height:100%;display:flex;align-items:center;justify-content:center}.imagen-grande-ios[_ngcontent-%COMP%]{max-width:100%;max-height:100%;object-fit:contain;transition:transform .35s ease}.nav-ios[_ngcontent-%COMP%]{position:absolute;top:50%;transform:translateY(-50%);width:42px;height:42px;border-radius:999px;border:1px solid rgba(148,163,184,.7);background:#0f172abf;color:#e5e7eb;display:grid;place-items:center;cursor:pointer;padding:0;box-shadow:0 10px 24px #000000b3,0 0 0 .5px #0f172ae6;transition:transform .16s ease,background .16s ease,border-color .16s ease,box-shadow .16s ease}.nav-ios[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:22px}.nav-ios[_ngcontent-%COMP%]:active{transform:translateY(-50%) scale(.96);background:#0f172af2;box-shadow:0 6px 18px #000000b3}.nav-ios.nav-ios--left[_ngcontent-%COMP%]{left:14px}@media (max-width: 768px){.nav-ios.nav-ios--left[_ngcontent-%COMP%]{left:8px}}.nav-ios.nav-ios--right[_ngcontent-%COMP%]{right:14px}@media (max-width: 768px){.nav-ios.nav-ios--right[_ngcontent-%COMP%]{right:8px}}@media (max-width: 480px){.btn-header-ios[_ngcontent-%COMP%]{font-size:11px;padding:5px 10px}.nav-ios[_ngcontent-%COMP%]{width:36px;height:36px}.nav-ios[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}}']}),x})()},4371:(E,P,l)=>{l.d(P,{a:()=>S});var m=l(467),t=l(1360),v=l(2881),n=l(7343),M=l(9417),I=l(1539),O=l(5806),d=l(2381),x=l(9557),h=l(9896),c=l(7636),a=l(4277);function u(o,_){if(1&o&&(t.j41(0,"div",12),t.EFF(1),t.k0s()),2&o){const s=t.XpG();t.R7$(),t.SpI(" ",s.auto.tipoVenta," ")}}function g(o,_){if(1&o){const s=t.RV6();t.j41(0,"button",13),t.bIt("click",function(e){t.eBV(s);const r=t.XpG();return r.agregarAFavoritos(r.auto._id),t.Njj(e.stopPropagation())}),t.nrm(1,"ion-icon",14),t.k0s()}if(2&o){const s=t.XpG();t.R7$(),t.Y8G("name",s.autosFavoritosIds.has(s.auto._id)?"heart":"heart-outline")}}function R(o,_){if(1&o){const s=t.RV6();t.j41(0,"button",15),t.bIt("click",function(e){t.eBV(s);const r=t.XpG();return r.eliminarDeFavoritos(r.auto._id),t.Njj(e.stopPropagation())}),t.nrm(1,"ion-icon",16),t.k0s()}}function w(o,_){1&o&&(t.j41(0,"div",17),t.nrm(1,"ion-spinner",18),t.k0s())}function y(o,_){if(1&o&&(t.j41(0,"p",19),t.EFF(1),t.nI1(2,"currency"),t.nI1(3,"currency"),t.k0s()),2&o){const s=t.XpG();t.R7$(),t.SpI(" ",(null==s.auto||null==s.auto.version?null:s.auto.version.length)>1?"Desde "+t.ii3(2,1,s.obtenerPrecioMinimo(s.auto.version),"MXN","symbol","1.0-0"):t.ii3(3,6,null==s.auto.version||null==s.auto.version[0]?null:s.auto.version[0].Precio,"MXN","symbol","1.0-0")," ")}}function T(o,_){if(1&o&&(t.j41(0,"p",19),t.EFF(1),t.nI1(2,"currency"),t.k0s()),2&o){const s=t.XpG();t.R7$(),t.SpI(" ",t.ii3(2,1,s.auto.precio.porDia,"MXN","symbol","1.0-0")," ")}}function D(o,_){if(1&o&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"number"),t.k0s()),2&o){const s=t.XpG();t.R7$(),t.SpI("",t.bMT(2,1,s.auto.kilometraje)," km")}}function j(o,_){if(1&o&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&o){const s=t.XpG();t.R7$(),t.JRh(s.auto.transmision)}}function F(o,_){if(1&o&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&o){const s=t.XpG();t.R7$(),t.JRh(s.auto.ubicacion.ciudad)}}let S=(()=>{var o;class _{constructor(i,e,r,p,f,b,C,k){this.generalService=i,this.router=e,this.carsService=r,this.contactosService=p,this.modalCtrl=f,this.route=b,this.motosService=C,this.camionesService=k,this.autosFavoritosIds=new Set,this.ubicacion="",this.esMio=!1,this.refrescarAutos=new t.bkB,this.FormatoPrecios=!1,this.autosFavoritos=[],this.mostrarPendientes=!1,this.MyRole=null,this.isLoggedIn=!1,this.imagenCargada=!1}ngOnInit(){this.generalService.tokenExistente$.subscribe(e=>{this.isLoggedIn=e}),this.generalService.tipoRol$.subscribe(e=>{this.MyRole=e});const i=localStorage.getItem("user");if(i){const e=JSON.parse(i);this.mostrarPendientes="glenditaa.003@gmail.com"===e.email}this.FormatoPrecios="mis_autos_renta"===this.ubicacion,this.verificadorCarga=setInterval(()=>{var e;const r=new Image;r.src=null===(e=this.auto)||void 0===e||null===(e=e.imagenes)||void 0===e?void 0:e[0],r.complete&&0!==r.naturalHeight&&(this.imagenCargada=!0,clearInterval(this.verificadorCarga))},200)}onImagenCargada(){this.imagenCargada=!0,clearInterval(this.verificadorCarga)}ficha(i){const r=/^\/search\/vehiculos\/[^\/]+$/.test(this.router.url);localStorage.setItem("origenFicha",String(r)),"auto"===i.vehiculo?this.router.navigate(["/ficha","autos",i._id]):"moto"===i.vehiculo?this.router.navigate(["/ficha","motos",i._id]):"renta"===i.vehiculo?this.router.navigate(["/renta-ficha",i._id]):"camion"===i.vehiculo?this.router.navigate(["/ficha","camiones",i._id]):console.warn("Tipo de veh\xedculo no reconocido:",i.vehiculo)}agregarAFavoritos(i){var e=this;return(0,m.A)(function*(){if(!e.isLoggedIn)return e.router.navigate(["/inicio"]),void e.generalService.alert("Inicia sesi\xf3n","Debes iniciar sesi\xf3n para poder agregar este veh\xedculo a tus favoritos.","info");var r;yield e.generalService.loading("Cargando..."),e.carsService.agregarFavorito(i).subscribe({next:(r=(0,m.A)(function*(){e.refrescarAutos.emit(e.ubicacion),yield e.generalService.loadingDismiss()}),function(){return r.apply(this,arguments)}),error:function(){var r=(0,m.A)(function*(p){var f;yield e.generalService.loadingDismiss();const b=(null===(f=p.error)||void 0===f?void 0:f.message)||"No se pudo agregar el auto a favoritos. Intenta m\xe1s tarde.";yield e.generalService.alert("Error",b,"danger")});return function(f){return r.apply(this,arguments)}}()})})()}toggleEstado(i,e){e.stopPropagation(),("mis_motos"===this.ubicacion?this.motosService:"mis_camiones"===this.ubicacion?this.camionesService:this.carsService).toggleEstadoVehiculo(i._id).subscribe({next:()=>{i.estadoVehiculo="disponible"===i.estadoVehiculo?"vendido":"disponible",this.generalService.alert("Estado actualizado",`Estado cambiado a "${i.estadoVehiculo.toUpperCase()}".`,"success")},error:b=>{var C;const k=(null==b||null===(C=b.error)||void 0===C?void 0:C.message)||"Error al cambiar el estado.";this.generalService.alert("Error",k,"danger")}})}eliminarDeFavoritos(i){this.carsService.eliminarFavorito(i).subscribe({next:()=>{this.autosFavoritos=this.autosFavoritos.filter(e=>e._id!==i),this.refrescarAutos.emit(this.ubicacion)},error:e=>{},complete:()=>{this.generalService.loadingDismiss()}})}update_car(i,e){this.router.navigate("mis_motos"===this.ubicacion?["/update-car","motos",i._id]:"mis_camiones"===this.ubicacion?["/update-car","camiones",i._id]:"mis_autos"===this.ubicacion?["/update-car","autos",i._id]:"mis_autos_renta"===this.ubicacion?["/edit-renta",i._id]:["/update-car","renta",i._id])}onCardClick(i,e){e.stopPropagation(),"mis_autos"!==this.ubicacion&&"mis_motos"!==this.ubicacion&&"mis_camiones"!==this.ubicacion&&"mis_autos"!==this.ubicacion&&"mis_autos_renta"!==this.ubicacion?this.ficha(i):this.update_car(i,this.ubicacion)}abrirModalImagen(i){var e=this;return(0,m.A)(function*(r,p=0){yield(yield e.modalCtrl.create({component:I.o,componentProps:{imagenes:r,indice:p},cssClass:"modal-imagen-personalizado",backdropDismiss:!0,showBackdrop:!0})).present()}).apply(this,arguments)}obtenerPrecioMinimo(i){return Math.min(...i.map(e=>e.Precio))}}return(o=_).\u0275fac=function(i){return new(i||o)(t.rXU(O.O),t.rXU(d.Ix),t.rXU(x.R),t.rXU(h.q),t.rXU(n.W3),t.rXU(d.nX),t.rXU(c.A),t.rXU(a.L))},o.\u0275cmp=t.VBU({type:o,selectors:[["app-cartas"]],inputs:{auto:"auto",autosFavoritosIds:"autosFavoritosIds",ubicacion:"ubicacion",esMio:"esMio"},outputs:{refrescarAutos:"refrescarAutos"},decls:16,vars:16,consts:[[1,"card-ios",3,"click"],["class","badge-tipo",4,"ngIf"],["class","fav-btn",3,"click",4,"ngIf"],["class","fav-btn delete",3,"click",4,"ngIf"],[1,"img-box"],["loading","lazy",3,"load","error","src","alt"],["class","loading",4,"ngIf"],[1,"info-box"],[1,"title"],["class","price",4,"ngIf"],[1,"specs"],[4,"ngIf"],[1,"badge-tipo"],[1,"fav-btn",3,"click"],[3,"name"],[1,"fav-btn","delete",3,"click"],["name","trash-outline"],[1,"loading"],["name","crescent"],[1,"price"]],template:function(i,e){1&i&&(t.j41(0,"div",0),t.bIt("click",function(p){return e.onCardClick(e.auto,p)}),t.DNE(1,u,2,1,"div",1)(2,g,2,1,"button",2)(3,R,2,0,"button",3),t.j41(4,"div",4)(5,"img",5),t.bIt("load",function(){return e.onImagenCargada()})("error",function(){return e.imagenCargada=!0}),t.k0s(),t.DNE(6,w,2,0,"div",6),t.k0s(),t.j41(7,"div",7)(8,"h4",8),t.EFF(9),t.k0s(),t.DNE(10,y,4,11,"p",9)(11,T,3,6,"p",9),t.j41(12,"div",10),t.DNE(13,D,3,3,"span",11)(14,j,2,1,"span",11)(15,F,2,1,"span",11),t.k0s()()()),2&i&&(t.R7$(),t.Y8G("ngIf",null==e.auto?null:e.auto.tipoVenta),t.R7$(),t.Y8G("ngIf","favoritos"!==e.ubicacion),t.R7$(),t.Y8G("ngIf","favoritos"===e.ubicacion),t.R7$(2),t.AVh("oculta",!e.imagenCargada),t.Y8G("src",e.auto.imagenes[0],t.B4B)("alt",e.auto.modelo),t.R7$(),t.Y8G("ngIf",!e.imagenCargada),t.R7$(3),t.E5c(" ",e.auto.marca," \u2022 ",e.auto.modelo," ",e.auto.anio," "),t.R7$(),t.Y8G("ngIf",!e.FormatoPrecios),t.R7$(),t.Y8G("ngIf",e.FormatoPrecios),t.R7$(2),t.Y8G("ngIf",e.auto.kilometraje),t.R7$(),t.Y8G("ngIf",e.auto.transmision),t.R7$(),t.Y8G("ngIf",null==e.auto.ubicacion?null:e.auto.ubicacion.ciudad))},dependencies:[n.bv,n.iq,n.w2,v.MD,v.bT,v.QX,v.oe,M.X1],styles:['@charset "UTF-8";[_nghost-%COMP%]{display:block;height:100%}.card-ios[_ngcontent-%COMP%]{position:relative;background:#fff;border-radius:22px;padding:12px;box-shadow:0 8px 22px #0000001a,0 0 0 .4px #ffffffe6;border:1px solid rgba(0,0,0,.04);cursor:pointer;transition:transform .18s ease,box-shadow .18s ease;display:flex;flex-direction:column;height:100%}.card-ios[_ngcontent-%COMP%]:active{transform:scale(.97)}.img-box[_ngcontent-%COMP%]{position:relative;width:100%;height:190px;border-radius:18px;overflow:hidden;background:#f2f2f7;flex:0 0 190px}.img-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;display:block}.img-box[_ngcontent-%COMP%]   .loading[_ngcontent-%COMP%]{position:absolute;top:0;right:0;bottom:0;left:0;display:flex;align-items:center;justify-content:center;background:#f2f2f7}@media (max-width: 768px){.img-box[_ngcontent-%COMP%]{height:170px;flex:0 0 170px}}.fav-btn[_ngcontent-%COMP%]{position:absolute;top:10px;right:10px;z-index:3;border:none;background:#ffffffd9;-webkit-backdrop-filter:blur(6px);backdrop-filter:blur(6px);width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;box-shadow:0 2px 6px #00000026}.fav-btn[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:17px;color:#ff3b30}.fav-btn.delete[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#333}.info-box[_ngcontent-%COMP%]{margin-top:10px;flex:1;display:flex;flex-direction:column}.info-box[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:14px;font-weight:700;color:#111827;margin:0 0 6px}.info-box[_ngcontent-%COMP%]   .price[_ngcontent-%COMP%]{margin:0 0 8px;font-size:15px;font-weight:800;color:#ff3b30}.specs[_ngcontent-%COMP%]{display:flex;gap:6px;flex-wrap:wrap;margin-top:auto}.specs[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{background:#f2f2f7;padding:4px 8px;border-radius:999px;font-size:11px;font-weight:600;color:#374151}.badge-tipo[_ngcontent-%COMP%]{position:absolute;top:10px;left:10px;z-index:4;padding:4px 10px;font-size:11px;font-weight:700;border-radius:999px;background:#ffffffd9;-webkit-backdrop-filter:blur(6px);backdrop-filter:blur(6px);color:#111827;box-shadow:0 2px 6px #00000026;border:1px solid rgba(0,0,0,.05);text-transform:uppercase;letter-spacing:.4px}']}),_})()}}]);