"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2371],{1125:(H,S,v)=>{v.d(S,{o:()=>L});var M=v(7643),N=v(5312),h=v(6648),A=v(8810),y=v(6354),F=v(9437),x=v(5558),D=v(1360),c=v(9564),W=v(5806);let L=(()=>{var R;class T{get baseUrl(){return this._baseUrl}constructor(l,d,a){this.http=l,this.headersService=d,this.general=a,this._baseUrl=this.normalizeBaseUrl(N.c.api_key),this.BOOKING_BASE="/booking/bookings"}normalizeBaseUrl(l){return(l||"").replace(/\/+$/,"")}toParams(l){let d=new M.Nl;return Object.entries(l||{}).forEach(([a,u])=>{null==u||""===u||(Array.isArray(u)?u.forEach(s=>{d=d.append(a,String(s))}):d=d.set(a,String(u)))}),d}authJsonHeaders$(){return(0,h.H)(this.headersService.obtenerToken()).pipe((0,y.T)(l=>this.headersService.getJsonHeaders(l)))}authMultipartHeaders$(){return(0,h.H)(this.headersService.obtenerToken()).pipe((0,y.T)(l=>this.headersService.getJsonHeaders(l).delete("Content-Type")))}buildApiCandidates(l){const d=this.baseUrl.replace(/\/+$/,""),a=l.startsWith("/")?l:`/${l}`,u=`${d}${a}`,f=`${/\/api$/.test(d)?d.replace(/\/api$/,""):`${d}/api`}${a}`,m=new Set([u.replace(/\/+$/,""),f.replace(/\/+$/,"")]);return Array.from(m)}withNoCache(l){return l.set("Cache-Control","no-cache").set("Pragma","no-cache").set("If-Modified-Since","0")}withNoCacheHeaders(l){return l instanceof M.Lr?this.withNoCache(l):{...l,"Cache-Control":"no-cache",Pragma:"no-cache","If-Modified-Since":"0"}}addCacheBuster(l){const d=Date.now().toString();return(null!=l?l:new M.Nl).set("_ts",d)}formatHttpErrorMessage(l){const d="Ocurri\xf3 un error al procesar la solicitud.";if(!l)return d;const a=[],u=l.error;if(u)if("string"==typeof u)a.push(u);else{var s;"string"==typeof u.message&&a.push(u.message),"string"==typeof u.error?a.push(u.error):null!==(s=u.error)&&void 0!==s&&s.message&&a.push(String(u.error.message)),Array.isArray(u.errors)&&u.errors.length>0&&a.push(...u.errors.map(f=>(null==f?void 0:f.msg)||(null==f?void 0:f.message)||f).filter(Boolean).map(String))}0===a.length&&l.message&&a.push(String(l.message));const e=Array.from(new Set(a.map(f=>f.trim()).filter(Boolean)));return e.length?e.join("\n"):d}handleHttpErrorWithContext(l,d){return a=>{var u;const s=null==a?void 0:a.error,e="string"==typeof(null==s?void 0:s.message)&&s.message.trim()||"string"==typeof(null==a?void 0:a.message)&&a.message.trim()||"No se pudo completar la acci\xf3n";let f="";return"string"==typeof(null==s?void 0:s.error)&&s.error.trim()?f=s.error.trim():null!=s&&null!==(u=s.error)&&void 0!==u&&u.message?f=String(s.error.message):Array.isArray(null==s?void 0:s.errors)&&s.errors.length&&(f=s.errors.map(m=>(null==m?void 0:m.msg)||(null==m?void 0:m.message)||String(m)).filter(Boolean).join("\n")),f||(f=this.formatHttpErrorMessage(a)),this.general.alert(e,f,"danger"),(0,A.$)(()=>a)}}getWithApiFallback(l,d,a){const[u,s]=this.buildApiCandidates(l),e=this.withNoCacheHeaders(d),f=this.handleHttpErrorWithContext("GET",l);return this.http.get(u,{headers:e,params:a}).pipe((0,F.W)(m=>404===(null==m?void 0:m.status)&&s?this.http.get(s,{headers:e,params:a}).pipe((0,F.W)(this.handleHttpErrorWithContext("GET",l))):f(m)))}postWithApiFallback(l,d,a,u){const[s,e]=this.buildApiCandidates(l),f=this.handleHttpErrorWithContext("POST",l);return this.http.post(s,d,{headers:a,params:u}).pipe((0,F.W)(m=>404===(null==m?void 0:m.status)&&e?this.http.post(e,d,{headers:a,params:u}).pipe((0,F.W)(this.handleHttpErrorWithContext("POST",l))):f(m)))}putWithApiFallback(l,d,a,u){const[s,e]=this.buildApiCandidates(l),f=this.handleHttpErrorWithContext("PUT",l);return this.http.put(s,d,{headers:a,params:u}).pipe((0,F.W)(m=>404===(null==m?void 0:m.status)&&e?this.http.put(e,d,{headers:a,params:u}).pipe((0,F.W)(this.handleHttpErrorWithContext("PUT",l))):f(m)))}deleteWithApiFallback(l,d,a,u){const[s,e]=this.buildApiCandidates(l),f=this.handleHttpErrorWithContext("DELETE",l);return this.http.request("DELETE",s,{headers:d,params:a,body:u}).pipe((0,F.W)(m=>404===(null==m?void 0:m.status)&&e?this.http.request("DELETE",e,{headers:d,params:a,body:u}).pipe((0,F.W)(this.handleHttpErrorWithContext("DELETE",l))):f(m)))}listarBookings(l={}){const d=this.addCacheBuster(this.toParams(l));return this.authJsonHeaders$().pipe((0,x.n)(a=>this.getWithApiFallback(`${this.BOOKING_BASE}`,a,d)))}getBookingById(l){return this.authJsonHeaders$().pipe((0,x.n)(d=>this.getWithApiFallback(`${this.BOOKING_BASE}/${l}`,d,this.addCacheBuster())))}getMyBookings(){return this.authJsonHeaders$().pipe((0,x.n)(l=>this.getWithApiFallback(`${this.BOOKING_BASE}/mine`,l,this.addCacheBuster())))}getBookingsByCar(l,d={}){const a=this.addCacheBuster(this.toParams(d));return this.authJsonHeaders$().pipe((0,x.n)(u=>this.getWithApiFallback(`${this.BOOKING_BASE}/car/${l}`,u,a)))}createBookingV2(l){const d={...l};if(d.fechaInicio=new Date(l.fechaInicio).toISOString(),d.fechaFin=new Date(l.fechaFin).toISOString(),"string"==typeof d.items)try{d.items=JSON.parse(d.items)}catch{return this.general.alert("Datos inv\xe1lidos","Formato inv\xe1lido de items (JSON).","danger"),(0,A.$)(()=>new Error("Formato inv\xe1lido de items (JSON)"))}return d.rentalCar&&d.fechaInicio&&d.fechaFin?new Date(d.fechaFin)<=new Date(d.fechaInicio)?(this.general.alert("Rango inv\xe1lido","fechaFin debe ser mayor a fechaInicio.","danger"),(0,A.$)(()=>new Error("Rango de fechas inv\xe1lido: fechaFin debe ser > fechaInicio."))):!0!==d.aceptoTerminos?(this.general.alert("T\xe9rminos","Debes aceptar los t\xe9rminos para continuar.","danger"),(0,A.$)(()=>new Error("Debes aceptar los t\xe9rminos para continuar."))):this.authJsonHeaders$().pipe((0,x.n)(a=>this.postWithApiFallback(`${this.BOOKING_BASE}`,d,a))):(this.general.alert("Campos faltantes","Faltan campos: rentalCar, fechaInicio, fechaFin","danger"),(0,A.$)(()=>new Error("Faltan campos: rentalCar, fechaInicio, fechaFin")))}acceptBooking(l,d={}){const a={};return!0===d.force&&(a.force=!0),!0===d.ignoreTraslape&&(a.ignoreTraslape=!0),!0===d.ignoreOverlap&&(a.ignoreOverlap=!0),this.authJsonHeaders$().pipe((0,x.n)(u=>this.postWithApiFallback(`${this.BOOKING_BASE}/${l}/accept`,a,u)))}startBooking(l){return this.authJsonHeaders$().pipe((0,x.n)(d=>this.postWithApiFallback(`${this.BOOKING_BASE}/${l}/start`,{},d)))}finishBooking(l){return this.authJsonHeaders$().pipe((0,x.n)(d=>this.postWithApiFallback(`${this.BOOKING_BASE}/${l}/finish`,{},d)))}cancelBooking(l,d){const a=d?{motivo:d}:{};return this.authJsonHeaders$().pipe((0,x.n)(u=>this.postWithApiFallback(`${this.BOOKING_BASE}/${l}/cancel`,a,u)))}setCheckIn(l,d=[],a){const u=new FormData;return(d||[]).forEach(s=>u.append("checkInFotos",s)),null!=a&&a.fecha&&u.append("fecha",a.fecha),null!=(null==a?void 0:a.combustible)&&u.append("combustible",String(a.combustible)),null!=(null==a?void 0:a.notas)&&u.append("notas",a.notas),null!=a&&a.existentes&&u.append("checkInFotosExistentes",JSON.stringify(a.existentes)),this.authMultipartHeaders$().pipe((0,x.n)(s=>this.putWithApiFallback(`${this.BOOKING_BASE}/${l}/checkin`,u,s)))}setCheckOut(l,d=[],a){const u=new FormData;return(d||[]).forEach(s=>u.append("checkOutFotos",s)),null!=a&&a.fecha&&u.append("fecha",a.fecha),null!=(null==a?void 0:a.combustible)&&u.append("combustible",String(a.combustible)),null!=(null==a?void 0:a.notas)&&u.append("notas",a.notas),this.authMultipartHeaders$().pipe((0,x.n)(s=>this.putWithApiFallback(`${this.BOOKING_BASE}/${l}/checkout`,u,s)))}updatePayment(l,d){return this.authJsonHeaders$().pipe((0,x.n)(a=>this.putWithApiFallback(`${this.BOOKING_BASE}/${l}/payment`,d,a)))}updateDeposit(l,d){return this.authJsonHeaders$().pipe((0,x.n)(a=>this.putWithApiFallback(`${this.BOOKING_BASE}/${l}/deposit`,d,a)))}setContractUrl(l,d){return this.authJsonHeaders$().pipe((0,x.n)(a=>this.putWithApiFallback(`${this.BOOKING_BASE}/${l}/contract`,{url:d},a)))}replaceItems(l,d){return this.authJsonHeaders$().pipe((0,x.n)(a=>this.putWithApiFallback(`${this.BOOKING_BASE}/${l}/items`,{items:d},a)))}addLineItem(l,d){return this.authJsonHeaders$().pipe((0,x.n)(a=>this.postWithApiFallback(`${this.BOOKING_BASE}/${l}/items`,d,a)))}updateBookingPartial(l,d){return this.authJsonHeaders$().pipe((0,x.n)(a=>this.putWithApiFallback(`${this.BOOKING_BASE}/${l}`,d,a)))}removeLineItem(l,d){return this.authJsonHeaders$().pipe((0,x.n)(a=>this.deleteWithApiFallback(`${this.BOOKING_BASE}/${l}/items`,a,void 0,{index:d})))}deleteBooking(l){return this.authJsonHeaders$().pipe((0,x.n)(d=>this.deleteWithApiFallback(`${this.BOOKING_BASE}/${l}`,d)))}saveCheckInData(l,d){return this.authJsonHeaders$().pipe((0,x.n)(a=>this.putWithApiFallback(`${this.BOOKING_BASE}/${l}/checkin`,d,a)))}}return(R=T).\u0275fac=function(l){return new(l||R)(D.KVO(M.Qq),D.KVO(c.m),D.KVO(W.O))},R.\u0275prov=D.jDH({token:R,factory:R.\u0275fac,providedIn:"root"}),T})()},2371:(H,S,v)=>{v.r(S),v.d(S,{MisReservasPageModule:()=>Se});var M=v(2881),N=v(9417),h=v(7343),A=v(9870),y=v(467),F=v(3888),D=v(9974),c=v(8750),W=v(1853),L=v(4360),R=v(5225);const T=(0,W.L)(o=>function(i=null){o(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=i});function U(o,g){const{first:i,each:n,with:t=l,scheduler:r=(null!=g?g:F.E),meta:p=null}=function x(o){return o instanceof Date&&!isNaN(o)}(o)?{first:o}:"number"==typeof o?{each:o}:o;if(null==i&&null==n)throw new TypeError("No timeout provided.");return(0,D.N)((_,b)=>{let C,k,P=null,O=0;const I=E=>{k=(0,R.N)(b,r,()=>{try{C.unsubscribe(),(0,c.Tg)(t({meta:p,lastValue:P,seen:O})).subscribe(b)}catch(B){b.error(B)}},E)};C=_.subscribe((0,L._)(b,E=>{null==k||k.unsubscribe(),O++,b.next(P=E),n>0&&I(n)},void 0,void 0,()=>{null!=k&&k.closed||null==k||k.unsubscribe(),P=null})),!O&&I(null!=i?"number"==typeof i?i:+i-r.now():n)})}function l(o){throw new T(o)}var d=v(9437),a=v(980),u=v(7673),s=v(4843),e=v(1360),f=v(1125);const m=()=>[1,2,3,4];function w(o,g){if(1&o&&(e.j41(0,"ion-badge",10),e.EFF(1),e.k0s()),2&o){const i=e.XpG();e.Y8G("color",i.badgeColor(i.data.estatus)),e.R7$(),e.SpI(" ",i.data.estatus," ")}}function G(o,g){1&o&&(e.j41(0,"ion-item"),e.nrm(1,"ion-skeleton-text",13),e.k0s())}function j(o,g){1&o&&(e.j41(0,"ion-list",11),e.DNE(1,G,2,0,"ion-item",12),e.k0s()),2&o&&(e.R7$(),e.Y8G("ngForOf",e.lJ4(1,m)))}function z(o,g){if(1&o&&(e.j41(0,"ion-card-subtitle"),e.EFF(1),e.k0s()),2&o){const i=e.XpG(2);e.R7$(),e.JRh(i.marcaModelo())}}function Y(o,g){if(1&o&&(e.qex(0),e.j41(1,"section",14),e.nrm(2,"ion-icon",15),e.j41(3,"div",16)(4,"b"),e.EFF(5),e.nI1(6,"date"),e.k0s(),e.j41(7,"span",17),e.EFF(8,"\u2192"),e.k0s(),e.j41(9,"b"),e.EFF(10),e.nI1(11,"date"),e.k0s()(),e.j41(12,"ion-chip",18),e.EFF(13),e.k0s()(),e.j41(14,"ion-card",19)(15,"ion-card-header")(16,"ion-card-title"),e.EFF(17,"Resumen"),e.k0s(),e.DNE(18,z,2,1,"ion-card-subtitle",9),e.k0s(),e.j41(19,"ion-card-content")(20,"div",20)(21,"div",21)(22,"small"),e.EFF(23,"Moneda"),e.k0s(),e.j41(24,"div",22),e.nrm(25,"ion-icon",23),e.EFF(26),e.k0s()(),e.j41(27,"div",21)(28,"small"),e.EFF(29,"Total"),e.k0s(),e.j41(30,"div",24),e.nrm(31,"ion-icon",25),e.EFF(32),e.nI1(33,"currency"),e.k0s()()()()(),e.j41(34,"ion-accordion-group",26)(35,"ion-accordion",27)(36,"ion-item",28)(37,"ion-label"),e.EFF(38,"Personas"),e.k0s()(),e.j41(39,"div",29)(40,"div",30)(41,"ion-card",31)(42,"ion-card-header")(43,"ion-card-title"),e.EFF(44,"Cliente"),e.k0s()(),e.j41(45,"ion-card-content"),e.EFF(46),e.k0s()(),e.j41(47,"ion-card",31)(48,"ion-card-header")(49,"ion-card-title"),e.EFF(50,"Propietario"),e.k0s()(),e.j41(51,"ion-card-content"),e.EFF(52),e.k0s()()()()(),e.j41(53,"ion-accordion",32)(54,"ion-item",28)(55,"ion-label"),e.EFF(56,"Operativo"),e.k0s()(),e.j41(57,"div",29)(58,"div",30)(59,"ion-card",31)(60,"ion-card-header")(61,"ion-card-title"),e.EFF(62,"Check-In"),e.k0s()(),e.j41(63,"ion-card-content")(64,"div")(65,"b"),e.EFF(66,"Fecha:"),e.k0s(),e.EFF(67),e.k0s(),e.j41(68,"div")(69,"b"),e.EFF(70,"Combustible:"),e.k0s(),e.EFF(71),e.k0s(),e.j41(72,"div")(73,"b"),e.EFF(74,"Notas:"),e.k0s(),e.EFF(75),e.k0s()()(),e.j41(76,"ion-card",31)(77,"ion-card-header")(78,"ion-card-title"),e.EFF(79,"Check-Out"),e.k0s()(),e.j41(80,"ion-card-content")(81,"div")(82,"b"),e.EFF(83,"Fecha:"),e.k0s(),e.EFF(84),e.k0s(),e.j41(85,"div")(86,"b"),e.EFF(87,"Combustible:"),e.k0s(),e.EFF(88),e.k0s(),e.j41(89,"div")(90,"b"),e.EFF(91,"Notas:"),e.k0s(),e.EFF(92),e.k0s()()()()()()(),e.bVm()),2&o){let i,n;const t=e.XpG();e.R7$(5),e.JRh(e.i5U(6,14,t.data.fechaInicio,"medium")),e.R7$(5),e.JRh(e.i5U(11,17,t.data.fechaFin,"medium")),e.R7$(3),e.SpI("",t.dias()," d\xeda(s)"),e.R7$(5),e.Y8G("ngIf",t.car),e.R7$(8),e.JRh(t.currency()),e.R7$(6),e.SpI(" ",e.brH(33,20,t.data.total,t.currency(),"symbol-narrow")," "),e.R7$(14),e.JRh(t.clienteNombre()),e.R7$(6),e.JRh(t.ownerNombre()),e.R7$(15),e.SpI(" ",(null==t.data.checkIn?null:t.data.checkIn.fecha)||"\u2014",""),e.R7$(4),e.SpI(" ",null!==(i=null==t.data.checkIn?null:t.data.checkIn.combustible)&&void 0!==i?i:"\u2014"," "),e.R7$(4),e.SpI(" ",(null==t.data.checkIn?null:t.data.checkIn.notas)||"\u2014",""),e.R7$(9),e.SpI(" ",(null==t.data.checkOut?null:t.data.checkOut.fecha)||"\u2014",""),e.R7$(4),e.SpI(" ",null!==(n=null==t.data.checkOut?null:t.data.checkOut.combustible)&&void 0!==n?n:"\u2014"," "),e.R7$(4),e.SpI(" ",(null==t.data.checkOut?null:t.data.checkOut.notas)||"\u2014","")}}let V=(()=>{var o;class g{constructor(n,t,r,p){this.reservas=n,this.modalCtrl=t,this.cdr=r,this.toast=p,this.viewerOnly=!1,this.updated=new e.bkB,this.closed=new e.bkB,this.loading=!0,this.car=null,this.myUserId=null}ngOnInit(){var n,t;if(this.myUserId=this.leerUsuarioId(),this.booking)return this.data=this.booking,this.car=null!==(n=null===(t=this.data)||void 0===t?void 0:t.rentalCar)&&void 0!==n?n:null,this.loading=!1,void this.cdr.markForCheck();this.bookingId?this.fetchBookingPopulada(this.bookingId):(this.loading=!1,this.cdr.markForCheck())}fetchBookingPopulada(n){var r,t=this;this.loading=!0,this.cdr.markForCheck(),this.reservas.getBookingById(n).subscribe({next:r=>{var p;this.data=r,this.car=null!==(p=null==r?void 0:r.rentalCar)&&void 0!==p?p:null,this.loading=!1,this.cdr.markForCheck()},error:(r=(0,y.A)(function*(){t.loading=!1,t.cdr.markForCheck(),yield t.toastMsg("No se pudo cargar la reserva","danger"),t.dismiss()}),function(){return r.apply(this,arguments)})})}clienteNombre(){var n;const t=null===(n=this.data)||void 0===n?void 0:n.usuario;return t?"object"==typeof t?(null===(r=t.nombre)||void 0===r?void 0:r.trim())||(null===(p=t.email)||void 0===p?void 0:p.trim())||"Cliente":"string"==typeof t&&this.shortId(t)||"Cliente":"Cliente";var r,p}ownerNombre(){var n,t,r;const p=null===(n=this.data)||void 0===n?void 0:n.rentalCar,_=null==p?void 0:p.propietarioId;var b,C;if(_&&"object"==typeof _)return(null===(b=_.nombre)||void 0===b?void 0:b.trim())||(null===(C=_.email)||void 0===C?void 0:C.trim())||"\u2014";if("string"==typeof _)return this.shortId(_)||"\u2014";const k=(null===(t=this.data)||void 0===t?void 0:t.rentalCarOwner)||(null===(r=this.data)||void 0===r?void 0:r.propietario);var P,O;return k&&"object"==typeof k?(null===(P=k.nombre)||void 0===P?void 0:P.trim())||(null===(O=k.email)||void 0===O?void 0:O.trim())||"\u2014":"string"==typeof k&&this.shortId(k)||"\u2014"}badgeColor(n){switch(n){case"pendiente":default:return"medium";case"aceptada":return"primary";case"en_curso":return"warning";case"finalizada":return"success";case"cancelada":return"danger"}}currency(){var n;return(null===(n=this.data)||void 0===n?void 0:n.moneda)||"MXN"}dias(){var n,t,r;const p=new Date((null===(n=this.data)||void 0===n?void 0:n.fechaInicio)||new Date).getTime(),_=new Date((null===(t=this.data)||void 0===t?void 0:t.fechaFin)||(null===(r=this.data)||void 0===r?void 0:r.fechaInicio)||new Date).getTime(),b=Math.ceil((_-p)/864e5);return Math.max(1,b||1)}marcaModelo(){const n=this.car;return n?[n.marca,n.modelo,n.anio].filter(Boolean).join(" "):"Auto"}leerUsuarioId(){try{const n=localStorage.getItem("user");if(!n)return null;const t=JSON.parse(n);return(null==t?void 0:t._id)||(null==t?void 0:t.id)||(null==t?void 0:t.uid)||(null==t?void 0:t.userId)||(null==t?void 0:t.usuarioId)||null}catch{return null}}shortId(n){return"string"!=typeof n?null:n.length>=6?`#${n.slice(0,6)}`:n||null}toastMsg(n){var t=this;return(0,y.A)(function*(r,p="success"){yield(yield t.toast.create({message:r,duration:1600,color:p})).present()}).apply(this,arguments)}dismiss(){var n=this;return(0,y.A)(function*(){n.closed.emit(),yield n.modalCtrl.dismiss()})()}}return(o=g).\u0275fac=function(n){return new(n||o)(e.rXU(f.o),e.rXU(h.W3),e.rXU(e.gRc),e.rXU(h.K_))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-detalle-reserva-modal"]],inputs:{booking:"booking",bookingId:"bookingId",viewerOnly:"viewerOnly"},outputs:{updated:"updated",closed:"closed"},decls:13,vars:5,consts:[["collapse","fade","translucent","true"],[1,"ios-toolbar"],[1,"title-line"],[3,"color",4,"ngIf"],["slot","end"],["fill","clear",1,"close-btn",3,"click"],["name","close-outline"],[1,"ios-content",3,"fullscreen"],["class","skeleton-list",4,"ngIf"],[4,"ngIf"],[3,"color"],[1,"skeleton-list"],[4,"ngFor","ngForOf"],["animated","",2,"width","100%","height","62px"],[1,"eyebrow-ios"],["name","calendar-outline"],[1,"dates"],[1,"arrow"],["outline","",1,"chip-ios"],[1,"ios-card","resume-card"],[1,"grid-ios"],[1,"cell"],[1,"row"],["name","card-outline"],[1,"row","strong"],["name","cash-outline"],[1,"ios-accordion-group"],["value","personas"],["slot","header",1,"ios-accordion-header"],["slot","content",1,"pad-ios"],[1,"two-ios"],[1,"ios-card","mini-card"],["value","operativo"]],template:function(n,t){1&n&&(e.j41(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-title")(3,"div",2)(4,"span"),e.EFF(5),e.k0s(),e.DNE(6,w,2,2,"ion-badge",3),e.k0s()(),e.j41(7,"ion-buttons",4)(8,"ion-button",5),e.bIt("click",function(){return t.dismiss()}),e.nrm(9,"ion-icon",6),e.k0s()()()(),e.j41(10,"ion-content",7),e.DNE(11,j,2,2,"ion-list",8)(12,Y,93,24,"ng-container",9),e.k0s()),2&n&&(e.R7$(5),e.SpI("Reserva #",t.data.codigo||t.data._id||"\u2014",""),e.R7$(),e.Y8G("ngIf",null==t.data?null:t.data.estatus),e.R7$(4),e.Y8G("fullscreen",!0),e.R7$(),e.Y8G("ngIf",t.loading),e.R7$(),e.Y8G("ngIf",!t.loading&&t.data))},dependencies:[M.MD,M.Sq,M.bT,M.oe,M.vh,h.bv,h.xk,h.YH,h.In,h.Jm,h.QW,h.b_,h.I9,h.ME,h.HW,h.tN,h.ZB,h.W9,h.eU,h.iq,h.uz,h.he,h.nf,h.ds,h.BC,h.ai],styles:["[_nghost-%COMP%]{--ink: #111827;--muted: #6b7280;--border: rgba(0, 0, 0, .08);--surface: #fff;--surface-2: #f5f7fa;--brand-red: #ff3b30}.ios-toolbar[_ngcontent-%COMP%]{--background: #ffffffcc;backdrop-filter:saturate(180%) blur(20px);-webkit-backdrop-filter:saturate(180%) blur(20px);border-bottom:1px solid rgba(0,0,0,.08);--color: var(--ink);padding-left:12px}.close-btn[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:26px;color:var(--ink)}.title-line[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-weight:700;color:var(--ink)}.title-line[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]{--border-radius: 999px;--padding-start: 10px;--padding-end: 10px;font-weight:600}.ios-content[_ngcontent-%COMP%]{--background: #f6f7f9;padding-bottom:24px}.eyebrow-ios[_ngcontent-%COMP%]{margin:16px 14px 10px;padding:14px;border-radius:18px;display:flex;align-items:center;gap:10px;background:var(--surface);border:1px solid var(--border);box-shadow:0 8px 24px #0000000f}.eyebrow-ios[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--brand-red);font-size:20px}.eyebrow-ios[_ngcontent-%COMP%]   .dates[_ngcontent-%COMP%]{display:flex;gap:6px;font-weight:600}.eyebrow-ios[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%]{opacity:.5}.chip-ios[_ngcontent-%COMP%]{margin-left:auto;--background: #fff;--color: var(--ink);--border-radius: 999px;--border-color: rgba(0,0,0,.12);font-weight:600}.ios-card[_ngcontent-%COMP%]{background:var(--surface);border-radius:20px;border:1px solid var(--border);box-shadow:0 12px 32px #00000012;margin:14px}.ios-card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]{padding-bottom:4px}.ios-card[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]{font-weight:700;color:var(--ink)}.ios-card[_ngcontent-%COMP%]   ion-card-subtitle[_ngcontent-%COMP%]{color:var(--muted);font-weight:500}.grid-ios[_ngcontent-%COMP%]{margin-top:8px;display:grid;grid-template-columns:1fr 1fr;gap:14px}.cell[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:12px;color:var(--muted)}.row[_ngcontent-%COMP%]{margin-top:4px;display:flex;align-items:center;gap:6px;font-weight:600}.ios-accordion-group[_ngcontent-%COMP%]{margin:16px 14px}.ios-accordion-header[_ngcontent-%COMP%]{--background: #fff;--color: var(--ink);--border-radius: 16px;border-bottom:1px solid rgba(0,0,0,.05)}.ios-accordion-header[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-weight:700!important}.pad-ios[_ngcontent-%COMP%]{padding:14px;background:#fff}.two-ios[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:12px}.mini-card[_ngcontent-%COMP%]{border-radius:18px;border:1px solid var(--border);box-shadow:0 10px 24px #0000000f}.mini-card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]{border-bottom:1px solid rgba(0,0,0,.04)}.mini-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   div[_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{margin-top:6px}ion-item[_ngcontent-%COMP%]{--background: var(--surface);--color: var(--ink)}.skeleton-list[_ngcontent-%COMP%]   ion-skeleton-text[_ngcontent-%COMP%]{border-radius:14px}@media (max-width: 520px){.two-ios[_ngcontent-%COMP%], .grid-ios[_ngcontent-%COMP%]{grid-template-columns:1fr}}"],changeDetection:0}),g})();var Q=v(3104),Z=v(2381),K=v(9847),J=v(5473);const q=()=>[1,2,3,4],ee=()=>[1,2,3];function te(o,g){if(1&o&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&o){const i=e.XpG();e.R7$(),e.SpI("Total: ",i.datos.length||0,"")}}function ne(o,g){1&o&&(e.j41(0,"ion-chip",14),e.nrm(1,"ion-icon",15),e.j41(2,"ion-label"),e.EFF(3,"Registradas"),e.k0s()())}function oe(o,g){1&o&&(e.j41(0,"ion-item"),e.nrm(1,"ion-skeleton-text",17),e.k0s())}function ie(o,g){1&o&&(e.j41(0,"ion-list"),e.DNE(1,oe,2,0,"ion-item",16),e.k0s()),2&o&&(e.R7$(),e.Y8G("ngForOf",e.lJ4(1,q)))}function re(o,g){1&o&&(e.j41(0,"h2",18),e.EFF(1," Solicitudes de reserva "),e.k0s())}function ae(o,g){if(1&o&&(e.j41(0,"ion-card-subtitle"),e.EFF(1),e.k0s()),2&o){const i=e.XpG(2);e.R7$(),e.SpI(" ",i.pendingOwner.length," pendiente(s) ")}}function se(o,g){1&o&&(e.j41(0,"ion-item"),e.nrm(1,"ion-skeleton-text",21),e.k0s())}function le(o,g){1&o&&(e.j41(0,"ion-list"),e.DNE(1,se,2,0,"ion-item",16),e.k0s()),2&o&&(e.R7$(),e.Y8G("ngForOf",e.lJ4(1,ee)))}function ce(o,g){1&o&&(e.j41(0,"ion-item",22),e.nrm(1,"ion-icon",23),e.j41(2,"ion-label"),e.EFF(3,"Sin solicitudes pendientes por ahora."),e.k0s()())}function de(o,g){if(1&o&&(e.j41(0,"div",40),e.nrm(1,"img",41),e.k0s()),2&o){const i=e.XpG().$implicit;e.R7$(),e.Y8G("src",i._imgUrl,e.B4B)}}function pe(o,g){if(1&o&&(e.j41(0,"p",42),e.nrm(1,"ion-icon",43),e.EFF(2),e.k0s()),2&o){const i=e.XpG().$implicit;e.R7$(2),e.SpI(" ",null==i?null:i.notasCliente," ")}}function ue(o,g){1&o&&e.nrm(0,"ion-spinner",44)}function ge(o,g){1&o&&(e.j41(0,"span"),e.EFF(1,"Aceptar"),e.k0s())}function he(o,g){1&o&&e.nrm(0,"ion-spinner",44)}function fe(o,g){1&o&&(e.j41(0,"span"),e.EFF(1,"Cancelar"),e.k0s())}function me(o,g){if(1&o){const i=e.RV6();e.j41(0,"ion-card",25)(1,"div",26),e.DNE(2,de,2,1,"div",27),e.j41(3,"div",28)(4,"h3",29),e.EFF(5),e.j41(6,"ion-note",30),e.EFF(7),e.nI1(8,"number"),e.k0s()(),e.j41(9,"p",31),e.nrm(10,"ion-icon",32),e.EFF(11),e.k0s(),e.j41(12,"p",33),e.nrm(13,"ion-icon",34),e.EFF(14),e.nI1(15,"date"),e.nI1(16,"date"),e.j41(17,"ion-note",30),e.EFF(18),e.k0s()(),e.DNE(19,pe,3,1,"p",35),e.k0s(),e.j41(20,"div",36)(21,"ion-button",37),e.bIt("click",function(){const t=e.eBV(i).$implicit,r=e.XpG(3);return e.Njj(r.acceptPending(t))}),e.DNE(22,ue,1,0,"ion-spinner",38)(23,ge,2,0,"span",5),e.k0s(),e.j41(24,"ion-button",39),e.bIt("click",function(){const t=e.eBV(i).$implicit,r=e.XpG(3);return e.Njj(r.cancelar(t))}),e.DNE(25,he,1,0,"ion-spinner",38)(26,fe,2,0,"span",5),e.k0s()()()()}if(2&o){const i=g.$implicit,n=e.XpG(3);e.R7$(2),e.Y8G("ngIf",null==i?null:i._imgUrl),e.R7$(3),e.SpI(" ",n.displayUsuario(null==i?null:i.usuario)," "),e.R7$(2),e.Lme(" \u2022 ",(null==i?null:i.moneda)||"MXN"," ",e.i5U(8,16,null==i?null:i.total,"1.0-0"),""),e.R7$(4),e.Lme(" ",null==i||null==i._car?null:i._car.marca," ",null==i||null==i._car?null:i._car.modelo," "),e.R7$(3),e.Lme(" ",e.i5U(15,19,null==i?null:i.fechaInicio,"mediumDate")," \u2192 ",e.i5U(16,22,null==i?null:i.fechaFin,"mediumDate")," "),e.R7$(4),e.SpI(" (",null==i?null:i.dias," d\xeda(s))"),e.R7$(),e.Y8G("ngIf",null==i?null:i.notasCliente),e.R7$(2),e.Y8G("disabled",n.actingIds.has(i._id)),e.R7$(),e.Y8G("ngIf",n.actingIds.has(i._id)&&"accept"===n.actingAction),e.R7$(),e.Y8G("ngIf",!(n.actingIds.has(i._id)&&"accept"===n.actingAction)),e.R7$(),e.Y8G("disabled",n.actingIds.has(i._id)),e.R7$(),e.Y8G("ngIf",n.actingIds.has(i._id)&&"cancel"===n.actingAction),e.R7$(),e.Y8G("ngIf",!(n.actingIds.has(i._id)&&"cancel"===n.actingAction))}}function _e(o,g){if(1&o&&(e.j41(0,"ion-list"),e.DNE(1,me,27,25,"ion-card",24),e.k0s()),2&o){const i=e.XpG(2);e.R7$(),e.Y8G("ngForOf",i.pendingOwner)}}function ve(o,g){if(1&o&&(e.j41(0,"ion-card",19)(1,"ion-card-header")(2,"ion-card-title"),e.EFF(3,"Solicitudes de reserva (tus coches)"),e.k0s(),e.DNE(4,ae,2,1,"ion-card-subtitle",5),e.k0s(),e.j41(5,"ion-card-content"),e.DNE(6,le,2,2,"ion-list",5)(7,ce,4,0,"ion-item",20)(8,_e,2,1,"ion-list",5),e.k0s()()),2&o){const i=e.XpG();e.R7$(4),e.Y8G("ngIf",!i.loadingPending),e.R7$(2),e.Y8G("ngIf",i.loadingPending),e.R7$(),e.Y8G("ngIf",!i.loadingPending&&0===i.pendingOwner.length),e.R7$(),e.Y8G("ngIf",!i.loadingPending&&i.pendingOwner.length>0)}}function ke(o,g){1&o&&(e.j41(0,"div",45),e.nrm(1,"ion-icon",32),e.j41(2,"p"),e.EFF(3,"No hay reservas registradas."),e.k0s()())}function be(o,g){1&o&&(e.j41(0,"h2",18),e.EFF(1,"Tus reservas"),e.k0s())}function Ce(o,g){if(1&o&&(e.j41(0,"div",68),e.nrm(1,"img",69),e.k0s()),2&o){const i=e.XpG().$implicit;e.R7$(),e.Y8G("src",i._imgUrl,e.B4B)}}function xe(o,g){1&o&&e.nrm(0,"ion-spinner",44)}function Oe(o,g){1&o&&(e.j41(0,"span"),e.EFF(1,"Cancelar"),e.k0s())}function Me(o,g){if(1&o){const i=e.RV6();e.j41(0,"ion-button",70),e.bIt("click",function(){e.eBV(i);const t=e.XpG().$implicit,r=e.XpG(2);return e.Njj(r.cancelar(t))}),e.DNE(1,xe,1,0,"ion-spinner",38)(2,Oe,2,0,"span",5),e.k0s()}if(2&o){const i=e.XpG().$implicit,n=e.XpG(2);e.Y8G("disabled",n.actingIds.has(i._id)),e.R7$(),e.Y8G("ngIf",n.actingIds.has(i._id)&&"cancel"===n.actingAction),e.R7$(),e.Y8G("ngIf",!(n.actingIds.has(i._id)&&"cancel"===n.actingAction))}}function Pe(o,g){1&o&&(e.qex(0),e.EFF(1,"Check-In"),e.bVm())}function ye(o,g){1&o&&(e.qex(0),e.EFF(1,"Check-Out"),e.bVm())}function Ie(o,g){1&o&&(e.qex(0),e.EFF(1,"Ver"),e.bVm())}function we(o,g){if(1&o&&(e.qex(0),e.DNE(1,Pe,2,0,"ng-container",5)(2,ye,2,0,"ng-container",5)(3,Ie,2,0,"ng-container",5),e.bVm()),2&o){const i=e.XpG().$implicit;e.R7$(),e.Y8G("ngIf","aceptada"===i.estatus),e.R7$(),e.Y8G("ngIf","en_curso"===i.estatus),e.R7$(),e.Y8G("ngIf","finalizada"===i.estatus)}}function Fe(o,g){1&o&&e.EFF(0,"Ver")}function Ee(o,g){if(1&o){const i=e.RV6();e.j41(0,"ion-card",47)(1,"div",48),e.DNE(2,Ce,2,1,"div",49),e.j41(3,"div",50)(4,"div",51)(5,"ion-card-title",52),e.EFF(6),e.k0s(),e.j41(7,"ion-badge",53),e.EFF(8),e.k0s()(),e.j41(9,"div",54)(10,"div",55)(11,"ion-card-subtitle",56),e.nrm(12,"ion-icon",57),e.EFF(13),e.k0s(),e.j41(14,"ion-card-subtitle",58),e.nrm(15,"ion-icon",34),e.EFF(16),e.nI1(17,"date"),e.nI1(18,"date"),e.k0s()(),e.j41(19,"div",59)(20,"small"),e.EFF(21,"Total"),e.k0s(),e.j41(22,"div",60),e.nrm(23,"ion-icon",61),e.j41(24,"strong"),e.EFF(25),e.nI1(26,"number"),e.k0s(),e.j41(27,"span",62),e.EFF(28),e.k0s()()(),e.j41(29,"div",63),e.DNE(30,Me,3,3,"ion-button",64),e.j41(31,"ion-button",65),e.bIt("click",function(){const t=e.eBV(i).$implicit,r=e.XpG(2);return e.Njj(r.irAccion(t))}),e.DNE(32,we,4,3,"ng-container",66)(33,Fe,1,0,"ng-template",null,0,e.C5r),e.k0s(),e.j41(35,"ion-button",67),e.bIt("click",function(){const t=e.eBV(i).$implicit,r=e.XpG(2);return e.Njj(r.openDetalle(t))}),e.EFF(36,"Detalle"),e.k0s()()()()()()}if(2&o){const i=g.$implicit,n=e.sdS(34),t=e.XpG(2);e.BMQ("data-status",i.estatus),e.R7$(2),e.Y8G("ngIf",null==i?null:i._imgUrl),e.R7$(4),e.Lme(" ",null==i._car?null:i._car.marca," ",null==i._car?null:i._car.modelo," "),e.R7$(),e.Y8G("color",t.colorEstatus(i.estatus)),e.R7$(),e.JRh(i.estatus),e.R7$(5),e.SpI(" Reserva #",i.codigo||i._id," "),e.R7$(3),e.Lme(" ",e.i5U(17,14,i.fechaInicio,"medium")," \u2192 ",e.i5U(18,17,i.fechaFin,"medium")," "),e.R7$(9),e.JRh(e.i5U(26,20,i.total,"1.0-0")),e.R7$(3),e.JRh(i.moneda||"MXN"),e.R7$(2),e.Y8G("ngIf",t.puedeCancelar(i)),e.R7$(2),e.Y8G("ngIf",t.soyPropietarioDeAuto(i))("ngIfElse",n)}}function Ae(o,g){if(1&o&&(e.j41(0,"ion-list"),e.DNE(1,Ee,37,23,"ion-card",46),e.k0s()),2&o){const i=e.XpG();e.R7$(),e.Y8G("ngForOf",i.datos)("ngForTrackBy",i.trackByBooking)}}function Re(o,g){1&o&&(e.j41(0,"h2",18),e.EFF(1,"M\xe1s resultados"),e.k0s())}function $e(o,g){if(1&o){const i=e.RV6();e.j41(0,"ion-infinite-scroll",71),e.bIt("ionInfinite",function(t){e.eBV(i);const r=e.XpG();return e.Njj(r.cargarMas(t))}),e.nrm(1,"ion-infinite-scroll-content",72),e.k0s()}}function $(o,g){return X.apply(this,arguments)}function X(){return(X=(0,y.A)(function*(o,g,i="success"){yield(yield o.create({message:g,duration:1800,color:i})).present()})).apply(this,arguments)}const je=[{path:"",component:(()=>{var o;class g{constructor(n,t,r,p,_,b,C){this.reservas=n,this.rentaService=t,this.router=r,this.cdr=p,this.toast=_,this.modalCtrl=b,this.alertCtrl=C,this.loading=!1,this.datos=[],this.pendingOwner=[],this.loadingPending=!1,this.actingIds=new Set,this.actingAction=null,this.myUserId=null,this.myRole="invitado",this.page=1,this.limit=8,this.hasMore=!0,this.loadingMore=!1,this.myAll=[],this.ownerAll=[],this.mergedAll=[],this.myAllLoaded=!1,this.ownerAllLoaded=!1,this.sortBookingDesc=(k,P)=>(P.createdAt||P.fechaInicio||"").localeCompare(k.createdAt||k.fechaInicio||"")}ngOnInit(){const n=this.leerUsuario();this.myUserId=n.id,this.myRole=n.rol,this.cargar()}doRefresh(n){this.page=1,this.hasMore=!0,this.loadingMore=!1,this.myAllLoaded=!1,this.ownerAllLoaded=!1,this.myAll=[],this.ownerAll=[],this.mergedAll=[],this.pendingOwner=[],this.loadingPending=!1,this.actingIds.clear(),this.actingAction=null,this.cargar(()=>n.target.complete())}cargar(n){if(this.loading=!(this.myAllLoaded&&(!this.myUserId||this.ownerAllLoaded)),this.cdr.markForCheck(),(this.myAllLoaded?(0,u.of)(this.myAll):this.reservas.getMyBookings().pipe(U(6e3),(0,d.W)(()=>(0,u.of)([])))).subscribe(_=>{this.myAllLoaded||(this.myAll=(_||[]).sort(this.sortBookingDesc),this.myAllLoaded=!0),this.aplicarPaginaBase(this.myAll)}),!this.myUserId)return this.loading=!1,this.loadingMore=!1,this.cdr.markForCheck(),void(null==n||n());this.loadingPending=!0;const r={page:1,limit:100,sort:"-createdAt",ownerId:this.myUserId,rentalCarOwnerId:this.myUserId,owner:this.myUserId,propietarioId:this.myUserId};let p;p=this.ownerAllLoaded?(0,u.of)({bookings:this.ownerAll}):this.reservas.listarBookings(r).pipe(U(6e3),(0,d.W)(()=>(0,u.of)({total:0,page:1,pages:1,bookings:[]}))),p.pipe((0,a.j)(()=>{this.loading=!1,this.loadingMore=!1,this.loadingPending=!1,this.cdr.markForCheck(),null==n||n()})).subscribe(_=>{const b=(Array.isArray(_)?_:null==_?void 0:_.bookings)||[];if(!this.ownerAllLoaded){const k=b.filter(P=>{const O=null==P?void 0:P.rentalCar;return"string"==typeof O||!!O&&this.soyPropietarioDeAuto(P)});this.ownerAll=(k||[]).sort(this.sortBookingDesc),this.ownerAllLoaded=!0}this.pendingOwner=this.ownerAll.filter(k=>"pendiente"===(null==k?void 0:k.estatus)).map(k=>({...k,dias:this.calcDays(k.fechaInicio,k.fechaFin)}));const C=new Map;[...this.myAll,...this.ownerAll].forEach(k=>C.set(k._id,k)),this.mergedAll=Array.from(C.values()).sort(this.sortBookingDesc),this.aplicarPaginaBase(this.mergedAll),this.ensureCarImages()})}ensureCarImages(){var n=this;return(0,y.A)(function*(){const t=[...n.datos],r=n.rentaService.baseUrl,p=t.map(function(){var b=(0,y.A)(function*(C){try{var k,P;let O=C.rentalCar;if("string"==typeof O){const E=yield(0,s._)(n.rentaService.cochePorId(O));O=E,C._car=E}else C._car=O;let I=(null===(k=O)||void 0===k?void 0:k.imagenPrincipal)||(Array.isArray(null===(P=O)||void 0===P?void 0:P.imagenes)&&O.imagenes.length?O.imagenes[0]:null);I&&!/^https?:\/\//i.test(I)&&(I=`${r.replace(/\/api$/,"")}/${I.replace(/^\/+/,"")}`),I||(I="https://cdn-icons-png.flaticon.com/512/3202/3202926.png"),C._imgUrl=I}catch(O){console.warn("No se pudo cargar coche para reserva",C._id,O),C._imgUrl="https://cdn-icons-png.flaticon.com/512/3202/3202926.png"}return C});return function(C){return b.apply(this,arguments)}}()),_=yield Promise.all(p);n.datos=_,n.cdr.markForCheck()})()}carName(n){const t=n._car||n.rentalCar;return t&&"object"==typeof t?[t.marca,t.modelo,t.anio].filter(Boolean).join(" "):"Veh\xedculo sin datos"}cargarMas(n){if(!this.hasMore||this.loadingMore)return void n.target.complete();this.loadingMore=!0,this.page++;const t=this.mergedAll.length?this.mergedAll:this.myAll;this.datos=t.slice(0,this.page*this.limit),this.hasMore=this.datos.length<t.length,this.loadingMore=!1,this.cdr.markForCheck(),n.target.complete()}trackByBooking(n,t){return t._id}colorEstatus(n){switch(n){case"pendiente":default:return"medium";case"aceptada":return"primary";case"en_curso":return"warning";case"finalizada":return"success";case"cancelada":return"danger"}}leerUsuario(){try{const n=localStorage.getItem("user");if(!n)return{id:null,rol:"invitado"};const t=JSON.parse(n),r=(null==t?void 0:t._id)||(null==t?void 0:t.id)||(null==t?void 0:t.uid)||(null==t?void 0:t.userId)||(null==t?void 0:t.usuarioId)||null,p=((null==t?void 0:t.rol)||(null==t?void 0:t.role)||"invitado").toString().toLowerCase();return{id:r,rol:new Set(["admin","lotero","vendedor","cliente"]).has(p)?p:"invitado"}}catch{return{id:null,rol:"invitado"}}}soyPropietarioDeAuto(n){if(!this.myUserId)return!1;const t=(null==n?void 0:n.rentalCarOwnerId)||(null==n?void 0:n.propietarioId);if("string"==typeof t&&t)return t===this.myUserId;const r=null==n?void 0:n.rentalCar;if(r&&"object"==typeof r){const p=r.owner||r.ownerId||r.dueno||r.propietario||r.propietarioId||r.user||r.usuario;if("string"==typeof p)return p===this.myUserId;if(p&&"object"==typeof p){const _=(null==p?void 0:p._id)||(null==p?void 0:p.id)||(null==p?void 0:p.uid)||(null==p?void 0:p.userId)||null;if(_)return _===this.myUserId}if("string"==typeof(null==r?void 0:r.propietarioId))return r.propietarioId===this.myUserId;if("string"==typeof(null==r?void 0:r.ownerId))return r.ownerId===this.myUserId}return!1}esSolicitante(n){try{if(!n)return!1;const t=localStorage.getItem("user");if(!t)return!1;const r=JSON.parse(t),p=(null==r?void 0:r._id)||(null==r?void 0:r.id)||(null==r?void 0:r.uid)||(null==r?void 0:r.userId)||(null==r?void 0:r.usuarioId)||null;if(!p)return!1;const _=n.usuario;return!!_&&("string"==typeof _?_===p:((null==_?void 0:_._id)||(null==_?void 0:_.id)||(null==_?void 0:_.uid)||(null==_?void 0:_.userId)||null)===p)}catch{return!1}}normalizarFechaLocalISO(n){const t=new Date(n);return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`}esHoy(n){return this.normalizarFechaLocalISO(new Date)===this.normalizarFechaLocalISO(n)}tieneCheckIn(n){const t=null==n?void 0:n.checkIn;return!!t&&!!(null!=t.combustible||"string"==typeof t.notas&&t.notas.trim().length>0||Array.isArray(t.fotos)&&t.fotos.length>0||t.fecha)}isSameDayAsToday(n){const t=this.normalizarFechaLocalISO(new Date);return this.normalizarFechaLocalISO(n)===t}isAfterToday(n){const t=this.normalizarFechaLocalISO(new Date);return this.normalizarFechaLocalISO(n)>t}isBeforeToday(n){const t=this.normalizarFechaLocalISO(new Date);return this.normalizarFechaLocalISO(n)<t}puedeIniciar(n){return this.soyPropietarioDeAuto(n)&&"aceptada"===(null==n?void 0:n.estatus)&&this.esHoy(null==n?void 0:n.fechaInicio)&&this.tieneCheckIn(n)}puedeFinalizar(n){return this.soyPropietarioDeAuto(n)&&"en_curso"===(null==n?void 0:n.estatus)}puedeCancelar(n){if(!n)return!1;const t=n.estatus,r=this.soyPropietarioDeAuto(n),p=this.esSolicitante(n);return!(!r&&!p)&&("pendiente"===t||("aceptada"===t?!(!this.isAfterToday(n.fechaInicio)&&!this.isSameDayAsToday(n.fechaInicio))||r:"en_curso"===t&&r))}iniciarRenta(n){var t=this;return(0,y.A)(function*(){if(null==n||!n._id)return;if(!t.soyPropietarioDeAuto(n))return void(yield $(t.toast,"Solo el propietario puede iniciar la renta","warning"));if("aceptada"!==n.estatus)return void(yield $(t.toast,"La renta debe estar aceptada para iniciar","warning"));if(!t.esHoy(n.fechaInicio))return void(yield $(t.toast,"Solo puedes iniciar el d\xeda de inicio","warning"));if(!t.tieneCheckIn(n))return void(yield $(t.toast,"No puedes iniciar sin Check-In","danger"));t.actingAction="start",t.actingIds.add(n._id),t.cdr.markForCheck();const r=t.reservas;let p;var _;p="function"==typeof r.startBooking?r.startBooking(n._id):"function"==typeof r.setStatus?r.setStatus(n._id,"en_curso"):(0,u.of)({ok:!1}),p.subscribe({next:(_=(0,y.A)(function*(){const b=C=>C._id===n._id?{...C,estatus:"en_curso"}:C;t.ownerAll=t.ownerAll.map(b),t.myAll=t.myAll.map(b),t.mergedAll=t.mergedAll.map(b),t.datos=t.datos.map(b),yield $(t.toast,"Renta iniciada","success")}),function(){return _.apply(this,arguments)}),error:function(){var _=(0,y.A)(function*(){yield $(t.toast,"No se pudo iniciar la renta","danger")});return function(){return _.apply(this,arguments)}}(),complete:()=>{t.actingIds.delete(n._id),t.actingAction=null,t.cdr.markForCheck()}})})()}irCheckout(n){null!=n&&n._id&&this.soyPropietarioDeAuto(n)&&"en_curso"===n.estatus&&this.router.navigate(["/checkout",n._id])}irAccion(n){const t=this.soyPropietarioDeAuto(n),r=this.esSolicitante(n);if(t){if("aceptada"===n.estatus)return void this.router.navigate(["/checkin",n._id]);if("en_curso"===n.estatus)return void this.router.navigate(["/checkin",n._id],{queryParams:{viewerOnly:"1"}});if("finalizada"===n.estatus)return void this.router.navigate(["/checkout",n._id])}if(r){if("finalizada"===n.estatus)return void this.router.navigate(["/checkout",n._id],{queryParams:{viewerOnly:"1"}});if("aceptada"===n.estatus||"en_curso"===n.estatus)return void this.router.navigate(["/checkin",n._id],{queryParams:{viewerOnly:"1"}})}this.openDetalle(n)}openDetalle(n){var t=this;return(0,y.A)(function*(){const r=yield t.modalCtrl.create({component:V,componentProps:{bookingId:n._id,viewerOnly:!t.soyPropietarioDeAuto(n)},canDismiss:!0,showBackdrop:!0,breakpoints:[0,.6,.92],initialBreakpoint:.92});yield r.present();const{data:p}=yield r.onWillDismiss();if(null!=p&&p.updated){const _=p.updated,b=C=>C._id===_._id?_:C;t.ownerAll=t.ownerAll.map(b),t.myAll=t.myAll.map(b),t.mergedAll=t.mergedAll.map(b),t.datos=t.datos.map(b),t.cdr.markForCheck()}})()}acceptPending(n){null!=n&&n._id&&(this.actingAction="accept",this.actingIds.add(n._id),this.cdr.markForCheck(),this.reservas.acceptBooking(n._id).subscribe({next:()=>{this.ownerAll=this.ownerAll.map(t=>t._id===n._id?{...t,estatus:"aceptada"}:t),this.mergedAll=this.mergedAll.map(t=>t._id===n._id?{...t,estatus:"aceptada"}:t),this.pendingOwner=this.pendingOwner.filter(t=>t._id!==n._id),this.datos=this.datos.map(t=>t._id===n._id?{...t,estatus:"aceptada"}:t)},error:t=>console.error(t),complete:()=>{this.actingIds.delete(n._id),this.actingAction=null,this.cdr.markForCheck()}}))}cancelar(n){var t=this;return(0,y.A)(function*(){if(null==n||!n._id)return;if(!t.puedeCancelar(n)){let I="No puedes cancelar esta reserva";return"en_curso"===n.estatus&&(I="S\xf3lo el propietario puede cancelar una renta en curso"),void(yield $(t.toast,I,"warning"))}const r=t.soyPropietarioDeAuto(n),p=t.esSolicitante(n),b=`\xbfDeseas cancelar la reserva #${n.codigo||n._id}?`,k=r?"Cancelada por propietario":p?"Cancelada por cliente":"Cancelada",P=yield t.alertCtrl.create({header:"Cancelar reserva",message:b,buttons:[{text:"No",role:"cancel"},{text:"Cancelar",role:"destructive"}]});yield P.present();const{role:O}=yield P.onDidDismiss();var I;"destructive"===O&&(t.actingAction="cancel",t.actingIds.add(n._id),t.cdr.markForCheck(),t.reservas.cancelBooking(n._id,k).subscribe({next:(I=(0,y.A)(function*(){const E=B=>B._id===n._id?{...B,estatus:"cancelada"}:B;t.ownerAll=t.ownerAll.map(E),t.myAll=t.myAll.map(E),t.mergedAll=t.mergedAll.map(E),t.datos=t.datos.map(E),t.pendingOwner=t.pendingOwner.filter(B=>B._id!==n._id),yield $(t.toast,"Reserva cancelada","success")}),function(){return I.apply(this,arguments)}),error:function(){var I=(0,y.A)(function*(){yield $(t.toast,"No se pudo cancelar la reserva","danger")});return function(){return I.apply(this,arguments)}}(),complete:()=>{t.actingIds.delete(n._id),t.actingAction=null,t.cdr.markForCheck()}}))})()}aplicarPaginaBase(n){this.datos=n.slice(0,this.page*this.limit),this.hasMore=this.datos.length<n.length,this.cdr.markForCheck()}calcDays(n,t){const r=new Date(n).getTime(),p=new Date(t||n).getTime(),_=Math.ceil((p-r)/864e5);return Math.max(1,_||1)}displayUsuario(n){return n?"string"==typeof n?n:n.nombre||n.email||"Usuario":"Usuario"}}return(o=g).\u0275fac=function(n){return new(n||o)(e.rXU(f.o),e.rXU(Q.w),e.rXU(Z.Ix),e.rXU(e.gRc),e.rXU(h.K_),e.rXU(h.W3),e.rXU(h.hG))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-mis-reservas"]],standalone:!1,decls:25,vars:12,consts:[["noOwner",""],[1,"mis-reservas",3,"fullscreen"],["slot","fixed",3,"ionRefresh"],[1,"page-head"],[1,"sub"],[4,"ngIf"],[1,"quick-chips"],["color","danger","outline","true"],["name","alert-circle-outline"],["color","success","outline","true",4,"ngIf"],["class","section-title",4,"ngIf"],["class","solicitud-card",4,"ngIf"],["class","vacio",4,"ngIf"],["threshold","100px",3,"ionInfinite",4,"ngIf"],["color","success","outline","true"],["name","checkmark-circle-outline"],[4,"ngFor","ngForOf"],["animated","",2,"width","100%","height","86px"],[1,"section-title"],[1,"solicitud-card"],["lines","none",4,"ngIf"],["animated","",2,"width","60%"],["lines","none"],["name","checkmark-circle-outline","slot","start","color","success"],["class","solicitud-item",4,"ngFor","ngForOf"],[1,"solicitud-item"],[1,"solicitud-layout"],["class","solicitud-img",4,"ngIf"],[1,"solicitud-info"],[1,"nombre-usuario"],["color","medium"],[1,"auto-detalle"],["name","car-outline"],[1,"rango-fechas"],["name","calendar-outline"],["class","nota-cliente ion-text-wrap",4,"ngIf"],[1,"solicitud-acciones"],["size","small","color","success",3,"click","disabled"],["name","crescent",4,"ngIf"],["size","small","color","danger","fill","outline",3,"click","disabled"],[1,"solicitud-img"],["alt","Veh\xedculo solicitado",3,"src"],[1,"nota-cliente","ion-text-wrap"],["name","chatbubble-ellipses-outline"],["name","crescent"],[1,"vacio"],["class","booking-card",4,"ngFor","ngForOf","ngForTrackBy"],[1,"booking-card"],[1,"booking-layout"],["class","booking-img",4,"ngIf"],[1,"booking-info-block"],[1,"booking-header-row"],[1,"truncate"],[3,"color"],[1,"booking-details-row"],[1,"booking-info"],[1,"reserva-code"],["name","key-outline"],[1,"dates"],[1,"booking-price"],[1,"amount"],["name","cash-outline"],[1,"currency"],[1,"booking-actions"],["color","danger","fill","outline",3,"disabled","click",4,"ngIf"],["color","danger","fill","solid",3,"click"],[4,"ngIf","ngIfElse"],["color","medium","fill","outline",3,"click"],[1,"booking-img"],["alt","Imagen del coche","loading","lazy",3,"src"],["color","danger","fill","outline",3,"click","disabled"],["threshold","100px",3,"ionInfinite"],["loadingSpinner","bubbles","loadingText","Cargando m\xe1s..."]],template:function(n,t){1&n&&(e.nrm(0,"app-navbar"),e.j41(1,"ion-content",1)(2,"ion-refresher",2),e.bIt("ionRefresh",function(p){return t.doRefresh(p)}),e.nrm(3,"ion-refresher-content"),e.k0s(),e.j41(4,"div",3)(5,"h1"),e.EFF(6,"Mis reservas"),e.k0s(),e.j41(7,"p",4),e.EFF(8," Historial y acciones r\xe1pidas. "),e.DNE(9,te,2,1,"span",5),e.k0s(),e.j41(10,"div",6)(11,"ion-chip",7),e.nrm(12,"ion-icon",8),e.j41(13,"ion-label"),e.EFF(14),e.k0s()(),e.DNE(15,ne,4,0,"ion-chip",9),e.k0s()(),e.DNE(16,ie,2,2,"ion-list",5)(17,re,2,0,"h2",10)(18,ve,9,4,"ion-card",11)(19,ke,4,0,"div",12)(20,be,2,0,"h2",10)(21,Ae,2,2,"ion-list",5)(22,Re,2,0,"h2",10)(23,$e,2,0,"ion-infinite-scroll",13),e.nrm(24,"app-footer"),e.k0s()),2&n&&(e.R7$(),e.Y8G("fullscreen",!0),e.R7$(8),e.Y8G("ngIf",!t.loading),e.R7$(5),e.SpI("Pendientes: ",t.pendingOwner.length||0,""),e.R7$(),e.Y8G("ngIf",!t.loading&&(null==t.datos?null:t.datos.length)),e.R7$(),e.Y8G("ngIf",t.loading),e.R7$(),e.Y8G("ngIf",t.loadingPending||t.pendingOwner.length>0),e.R7$(),e.Y8G("ngIf",t.loadingPending||t.pendingOwner.length>0),e.R7$(),e.Y8G("ngIf",!t.loading&&0===t.datos.length),e.R7$(),e.Y8G("ngIf",!t.loading&&t.datos.length),e.R7$(),e.Y8G("ngIf",!t.loading&&t.datos.length),e.R7$(),e.Y8G("ngIf",t.hasMore&&!t.loading),e.R7$(),e.Y8G("ngIf",t.hasMore))},dependencies:[M.Sq,M.bT,h.In,h.Jm,h.b_,h.I9,h.ME,h.HW,h.tN,h.ZB,h.W9,h.iq,h.Ax,h.Hp,h.uz,h.he,h.nf,h.JI,h.To,h.Ki,h.ds,h.w2,K._,J.n,M.QX,M.vh],styles:['@charset "UTF-8";.mis-reservas[_ngcontent-%COMP%]{--text-dark: #111;--text-muted: #6b7280;--page-head-max: 1100px;--page-head-gutter: 16px}.page-head[_ngcontent-%COMP%]{padding:4px 12px 12px;width:min(var(--page-head-max),100% - var(--page-head-gutter) * 2);margin-inline:auto;padding-inline:var(--page-head-gutter);text-align:center}.page-head[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0 0 4px;font-weight:800;font-size:22px;color:var(--text-dark);position:relative}.page-head[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]:after{content:"";display:block;width:72px;height:3px;background:var(--ion-color-danger);border-radius:3px;margin-top:6px;margin-inline:auto}.page-head[_ngcontent-%COMP%]   .sub[_ngcontent-%COMP%]{margin:4px 0 8px;color:var(--text-muted)}.page-head[_ngcontent-%COMP%]   .quick-chips[_ngcontent-%COMP%]{display:flex;gap:6px;flex-wrap:wrap;justify-content:center}.section-title[_ngcontent-%COMP%]{margin:14px 12px 8px;font-size:14px;font-weight:800;letter-spacing:.02em;color:var(--text-dark);position:relative;text-transform:uppercase}.section-title[_ngcontent-%COMP%]:after{content:"";position:absolute;left:0;bottom:-6px;width:90px;height:2px;background:var(--ion-color-danger);border-radius:2px}.vacio[_ngcontent-%COMP%]{text-align:center;margin-top:60px;color:var(--ion-color-medium)}.vacio[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:64px;color:var(--ion-color-danger);margin-bottom:8px}.vacio[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:var(--text-dark)}ion-card.booking-card[_ngcontent-%COMP%]{margin:14px;border-radius:14px;background:#fff;color:var(--text-dark);box-shadow:0 10px 28px #0000001f;border:1px solid rgba(0,0,0,.06);overflow:hidden;position:relative;padding:0}ion-card.booking-card[_ngcontent-%COMP%]:before{content:"";position:absolute;left:0;top:0;bottom:0;width:4px;background:var(--ion-color-danger)}ion-card.booking-card[data-status=en_curso][_ngcontent-%COMP%]:before{background:var(--ion-color-warning)}ion-card.booking-card[data-status=aceptada][_ngcontent-%COMP%]:before{background:var(--ion-color-success)}ion-card.booking-card[data-status=cancelada][_ngcontent-%COMP%]:before, ion-card.booking-card[data-status=rechazada][_ngcontent-%COMP%]:before{background:var(--ion-color-medium)}.booking-layout[_ngcontent-%COMP%]{display:grid;grid-template-columns:280px 1fr;gap:0;align-items:stretch;min-height:200px}.booking-img[_ngcontent-%COMP%]{background:#f5f5f5;border-top-left-radius:14px;border-bottom-left-radius:14px;overflow:hidden;display:flex;align-items:center;justify-content:center}.booking-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.booking-info-block[_ngcontent-%COMP%]{display:grid;grid-template-rows:auto 1fr;border-left:1px solid rgba(0,0,0,.06)}.booking-header-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px 20px;border-bottom:1px solid rgba(0,0,0,.06)}.booking-header-row[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]{font-size:20px;font-weight:800;color:var(--text-dark);text-transform:capitalize}.booking-header-row[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]{font-size:13px;padding:5px 12px;border-radius:8px;text-transform:capitalize}.booking-details-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1.2fr .7fr .9fr;align-items:center;gap:10px;padding:16px 20px}.booking-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;gap:4px}.booking-info[_ngcontent-%COMP%]   ion-card-subtitle[_ngcontent-%COMP%]{font-size:13px;color:var(--text-muted);display:flex;align-items:center;gap:6px}.booking-info[_ngcontent-%COMP%]   ion-card-subtitle[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--ion-color-danger)}.booking-info[_ngcontent-%COMP%]   ion-card-subtitle.reserva-code[_ngcontent-%COMP%]{font-weight:500;color:#4b5563}.booking-price[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center}.booking-price[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:12px;color:var(--text-muted)}.booking-price[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{display:flex;align-items:baseline;gap:6px;font-size:17px;font-weight:700}.booking-price[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--ion-color-danger)}.booking-price[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]   .currency[_ngcontent-%COMP%]{font-weight:800}.booking-actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:stretch;gap:6px}.booking-actions[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{width:100%;--border-radius: 10px;font-size:14px;font-weight:700}.booking-actions[_ngcontent-%COMP%]   ion-button[color=danger][fill=solid][_ngcontent-%COMP%]{--background: var(--ion-color-danger);--color: #fff}.booking-actions[_ngcontent-%COMP%]   ion-button[color=medium][fill=outline][_ngcontent-%COMP%]{--border-color: #cbd5e1;--color: #334155}@media (max-width: 900px){.booking-layout[_ngcontent-%COMP%]{grid-template-columns:1fr}.booking-img[_ngcontent-%COMP%]{height:160px;border-radius:14px 14px 0 0}.booking-info-block[_ngcontent-%COMP%]{border-left:none;grid-template-rows:auto auto}.booking-header-row[_ngcontent-%COMP%]{padding:14px 16px}.booking-header-row[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]{font-size:18px}.booking-details-row[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:10px;padding:14px 16px}.booking-price[_ngcontent-%COMP%]{align-items:flex-start}.booking-actions[_ngcontent-%COMP%]{align-items:stretch}}.solicitud-card[_ngcontent-%COMP%]{margin:20px 14px;border-radius:16px;box-shadow:0 8px 24px #00000014;overflow:hidden;background:#fff;border:1px solid rgba(0,0,0,.05);position:relative}.solicitud-card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]{border-bottom:1px solid rgba(0,0,0,.06);padding:16px 20px}.solicitud-card[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]{font-weight:800;color:var(--text-dark)}.solicitud-card[_ngcontent-%COMP%]   ion-card-subtitle[_ngcontent-%COMP%]{color:var(--text-muted);font-size:14px}.solicitud-item[_ngcontent-%COMP%]{position:relative;background:#fff;border:1px solid rgba(0,0,0,.04);border-radius:14px;box-shadow:0 6px 16px #0000000f;margin:14px 0;padding:18px 22px;transition:.25s ease;display:grid;grid-template-columns:1fr auto;column-gap:24px;align-items:center}.solicitud-item[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0 auto 0 0;width:5px;background:var(--ion-color-danger);border-radius:4px 0 0 4px}.solicitud-item[_ngcontent-%COMP%]:hover{transform:translateY(-3px);box-shadow:0 10px 22px #0000001a}.solicitud-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px;min-width:0}.solicitud-info[_ngcontent-%COMP%]   .nombre-usuario[_ngcontent-%COMP%]{margin:0;font-size:17px;font-weight:800;color:var(--text-dark)}.solicitud-info[_ngcontent-%COMP%]   .monto[_ngcontent-%COMP%]{font-size:15px;font-weight:600;color:var(--ion-color-dark)}.solicitud-info[_ngcontent-%COMP%]   .rango-fechas[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:13px;color:var(--text-muted)}.solicitud-info[_ngcontent-%COMP%]   .rango-fechas[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--ion-color-danger);font-size:16px}.solicitud-info[_ngcontent-%COMP%]   .rango-fechas[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]{font-size:12px;color:var(--text-muted)}.solicitud-info[_ngcontent-%COMP%]   .nota-cliente[_ngcontent-%COMP%]{font-style:italic;color:#444;font-size:13px;display:flex;align-items:center;gap:6px}.solicitud-info[_ngcontent-%COMP%]   .nota-cliente[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--ion-color-danger)}.solicitud-acciones[_ngcontent-%COMP%]{justify-self:end;display:flex;flex-direction:column;align-items:flex-end;gap:8px;margin-left:12px}.solicitud-acciones[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--border-radius: 10px;font-weight:700;font-size:13px;padding-inline:18px;min-width:120px;width:auto}.solicitud-acciones[_ngcontent-%COMP%]   ion-button[color=success][_ngcontent-%COMP%]{--background: #22c55e;--color: #fff;box-shadow:0 4px 10px #22c55e4d}.solicitud-acciones[_ngcontent-%COMP%]   ion-button[color=danger][fill=outline][_ngcontent-%COMP%]{--border-color: var(--ion-color-danger);--color: var(--ion-color-danger);background:#fff}@media (max-width: 900px){.solicitud-item[_ngcontent-%COMP%]{grid-template-columns:1fr;row-gap:12px;text-align:center}.solicitud-info[_ngcontent-%COMP%]{align-items:center}.solicitud-acciones[_ngcontent-%COMP%]{justify-self:center;align-items:center;flex-direction:row;gap:10px;width:100%}.solicitud-acciones[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{flex:1;min-width:0}}@media (max-width: 900px){.solicitud-item[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch;text-align:center;padding:16px 18px}.solicitud-info[_ngcontent-%COMP%]{align-items:center}.solicitud-acciones[_ngcontent-%COMP%]{flex-direction:row;justify-content:center;margin:10px 0 0;width:100%}.solicitud-acciones[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{flex:1;min-width:0}}ion-skeleton-text[_ngcontent-%COMP%]{border-radius:12px}'],changeDetection:0}),g})()}];let Be=(()=>{var o;class g{}return(o=g).\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[A.iI.forChild(je),A.iI]}),g})(),Se=(()=>{var o;class g{}return(o=g).\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[M.MD,N.YN,h.bv,Be,K._,J.n]}),g})()},5473:(H,S,v)=>{v.d(S,{n:()=>l});var M=v(467),N=v(2881),h=v(7343),A=v(9467),y=v(6557),F=v(4771),x=v(7392),D=v(5083),c=v(1360),W=v(5806),L=v(9417),R=v(2381),T=v(9557);const U=["footerRoot"];let l=(()=>{var d;class a{constructor(s,e,f,m,w,G,j,z,Y){this.menu=s,this.generalService=e,this.popoverCtrl=f,this.fb=m,this.alertCtrl=w,this.router=G,this.modalCtrl=j,this.activatedRoute=z,this.carsService=Y,this.blog=[],this.mostrarMapa=!1,this.mostrarVerMas=!1,this.aceptoPopup=!1,this.YaseptePopup=!1,this.esDispositivoMovil=!1,this.dispositivo="",this.currentYear=(new Date).getFullYear(),this.destinoLat=20.6079,this.destinoLng=-100.3793,this.destinoLabel="WOAW Automotive - Oficinas Operativas",this.destinoDir="Blvd. Bernardo Quintana Arrioja 14, Alamos 2da Secc, 76160 Santiago de Quer\xe9taro, Qro."}ngOnInit(){var s=this;return(0,M.A)(function*(){localStorage.setItem("popUp","true"),"true"===localStorage.getItem("popUp")&&(s.YaseptePopup=!0),s.generalService.dispositivo$.subscribe(m=>{s.esDispositivoMovil="telefono"===m||"tablet"===m,s.dispositivo=m});const f=window.location.pathname;s.mostrarMapa=f.includes("/home")})()}ngAfterViewInit(){const s=this.footerRoot.nativeElement.querySelectorAll(".is-reveal"),e=new IntersectionObserver(f=>{f.forEach(m=>{m.isIntersecting&&(m.target.classList.add("visible"),e.unobserve(m.target))})},{threshold:.15});s.forEach(f=>e.observe(f))}abrirUbicacion(){return(0,M.A)(function*(){let e=20.607572064205126,f=-100.37906506352265;const m=encodeURIComponent("Blvd. Bernardo Quintana Arrioja 17, \xc1lamos 2da Secc, Santiago de Quer\xe9taro"),w=`https://www.google.com/maps/search/?api=1&query=${e},${f}`,G=D.Ii.getPlatform();if("android"!==G)if("ios"!==G)window.open(w,"_blank");else{const j=`http://maps.apple.com/?ll=${e},${f}&q=${m}`;try{yield x.P.open({url:j})}catch{window.open(w,"_blank")}}else{const j=`geo:${e},${f}?q=${e},${f}(${m})`;try{yield x.P.open({url:j})}catch{window.open(w,"_blank")}}})()}mostrarTerminos(){var s=this;return(0,M.A)(function*(){let e;e="telefono"===s.dispositivo?yield s.modalCtrl.create({component:A.W,componentProps:{onAceptar:()=>s.setAceptado("terminos",!0),onCancelar:()=>s.setAceptado("terminos",!1)},breakpoints:[0,.7,1],cssClass:"modal-perfil",initialBreakpoint:1,handle:!0,backdropDismiss:!0,showBackdrop:!0}):yield s.modalCtrl.create({component:A.W,componentProps:{onAceptar:()=>s.setAceptado("terminos",!0),onCancelar:()=>s.setAceptado("terminos",!1)},backdropDismiss:!0,showBackdrop:!0,cssClass:"modal-consentimiento"}),yield e.present()})()}setAceptado(s,e){!0===e?localStorage.setItem(s,"true"):(localStorage.setItem(s,"false"),this.generalService.alert({aviso:"Aviso de Privacidad",terminos:"T\xe9rminos y Condiciones"}[s],{aviso:"Por tu seguridad y protecci\xf3n de datos, es necesario aceptar el Aviso de Privacidad.",terminos:"Debes aceptar los T\xe9rminos y Condiciones para usar este servicio de forma segura y responsable."}[s],"info"),localStorage.removeItem(s))}abrirCorreo(){window.location.href="mailto:comercial@wo-aw.com"}mostrarAviso(){var s=this;return(0,M.A)(function*(){let e;e="telefono"===s.dispositivo?yield s.modalCtrl.create({component:y.X,componentProps:{onAceptar:()=>s.setAceptado("aviso",!0),onCancelar:()=>s.setAceptado("aviso",!1)},breakpoints:[0,.7,1],cssClass:"modal-perfil",initialBreakpoint:1,handle:!0,backdropDismiss:!0,showBackdrop:!0}):yield s.modalCtrl.create({component:y.X,componentProps:{onAceptar:()=>s.setAceptado("aviso",!0),onCancelar:()=>s.setAceptado("aviso",!1)},backdropDismiss:!0,showBackdrop:!0,cssClass:"modal-consentimiento"}),yield e.present()})()}handleContactoClick(s){s.preventDefault();const e="true"===localStorage.getItem("popUp");console.log(e),e?window.open("mailto:contacto@goautos.mx","_blank"):this.mostrarPopUp("email")}mostrarPopUp(s){var e=this;return(0,M.A)(function*(){if("true"===localStorage.getItem("popUp"))return"telefono"===s?window.open("tel:+524425516440"):"email"===s&&window.open("mailto:contacto@goautos.mx","_blank"),void e.generalService.alert("PopUp Aceptado","\xa1Gracias por aceptar el PopUp! Ahora puedes continuar con tu registro.","success");let m;m="telefono"===e.dispositivo?yield e.modalCtrl.create({component:F.I,breakpoints:[0,.7,1],cssClass:"modal-perfil",initialBreakpoint:1,handle:!0,backdropDismiss:!1,showBackdrop:!0}):yield e.modalCtrl.create({component:F.I,backdropDismiss:!1,showBackdrop:!0,cssClass:"modal-consentimiento"}),yield m.present();const{data:w}=yield m.onDidDismiss();e.popUpAceptado(w,s)})()}handleTelefonoClick(s){s.preventDefault(),s.stopPropagation(),"true"===localStorage.getItem("popUp")?window.open("tel:+524425516440"):this.mostrarPopUp("telefono")}popUpAceptado(s,e){var f=this;return(0,M.A)(function*(){s?(localStorage.setItem("popUp","true"),"telefono"===e?window.open("tel:+524425516440"):"email"===e&&window.open("mailto:contacto@goautos.mx","_blank"),f.generalService.alert("PopUp Aceptado","\xa1Gracias por aceptar el PopUp! Ahora puedes continuar con tu registro.","success")):console.error("El usuario no acept\xf3 el PopUp")})()}redirecion(s){this.router.navigate([s])}onCambioConsentimiento(s){this.aceptoPopup=!!s.detail.checked}aceptarConsentimiento(){this.aceptoPopup?(localStorage.setItem("popUp","true"),this.YaseptePopup=!0):this.generalService.alert("Consentimiento requerido","Debes aceptar el aviso de privacidad para continuar.","warning")}}return(d=a).\u0275fac=function(s){return new(s||d)(c.rXU(h._t),c.rXU(W.O),c.rXU(h.IE),c.rXU(L.ok),c.rXU(h.hG),c.rXU(R.Ix),c.rXU(h.W3),c.rXU(R.nX),c.rXU(T.R))},d.\u0275cmp=c.VBU({type:d,selectors:[["app-footer"]],viewQuery:function(s,e){if(1&s&&c.GBs(U,7),2&s){let f;c.mGM(f=c.lsd())&&(e.footerRoot=f.first)}},decls:47,vars:0,consts:[["footerRoot",""],[1,"woaw-footer"],[1,"wf-wrap"],[1,"wf-col","brand","is-reveal"],[1,"marca_title"],[1,"tagline"],[1,"legal-mini"],["type","button",1,"link",3,"click"],[1,"wf-col","contact","is-reveal"],[1,"contacto_title"],[1,"empresa"],[1,"ubicacion"],[1,"consent"],["href","","role","link",1,"dato",3,"click","keydown.enter","keydown.space"],[1,"horario"],["type","button",1,"btn-primary",3,"click"],["name","navigate-outline"],[1,"wf-col","explore","is-reveal"],[1,"explora_title"],[1,"social-row"],["href","https://www.instagram.com/woaw.mx/","target","_blank","aria-label","Instagram",1,"chip"],["name","logo-instagram"],["href","https://www.tiktok.com/@woaw.mx","target","_blank","aria-label","TikTok",1,"chip"],["name","logo-tiktok"],["href","https://www.facebook.com/share/16wiS1yd9L/?mibextid=wwXIfr","target","_blank","aria-label","Facebook",1,"chip"],["name","logo-facebook"],["href","https://wa.me/524427706776","target","_blank","aria-label","WhatsApp",1,"chip"],["name","logo-whatsapp"],["href","https://www.linkedin.com/company/woaw-automotive","target","_blank","aria-label","LinkedIn",1,"chip"],["name","logo-linkedin"],["href","https://mail.google.com/mail/?view=cm&fs=1&to=comercial@wo-aw.com\n          &su=Contacto%20desde%20la%20web%20Woaw\n          &body=Hola%20equipo%20Woaw,","target","_blank","aria-label","Correo Gmail",1,"chip"],["name","mail-outline"],[1,"copy"]],template:function(s,e){if(1&s){const f=c.RV6();c.j41(0,"footer",1,0)(2,"div",2)(3,"section",3)(4,"h2",4),c.EFF(5,"Woaw Automotive"),c.k0s(),c.j41(6,"p",5),c.EFF(7," Veh\xedculos, personas y rutas claras. Sin ruido, sin adornos innecesarios. "),c.k0s(),c.j41(8,"div",6)(9,"button",7),c.bIt("click",function(){return c.eBV(f),c.Njj(e.mostrarAviso())}),c.EFF(10," Aviso de Privacidad "),c.k0s(),c.j41(11,"button",7),c.bIt("click",function(){return c.eBV(f),c.Njj(e.mostrarTerminos())}),c.EFF(12," T\xe9rminos "),c.k0s()()(),c.j41(13,"section",8)(14,"h2",9),c.EFF(15,"Contacto"),c.k0s(),c.j41(16,"h3",10),c.EFF(17,"Woaw Automotive S.A. de C.V."),c.k0s(),c.j41(18,"p",11),c.EFF(19,"Santiago de Quer\xe9taro, M\xe9xico"),c.k0s(),c.j41(20,"p",12),c.EFF(21," Consentimiento registrado. Puedes escribirnos o llamarnos cuando quieras. "),c.k0s(),c.j41(22,"a",13),c.bIt("click",function(w){return c.eBV(f),c.Njj(e.handleTelefonoClick(w))})("keydown.enter",function(w){return c.eBV(f),c.Njj(e.handleTelefonoClick(w))})("keydown.space",function(w){return c.eBV(f),e.handleTelefonoClick(w),c.Njj(w.preventDefault())}),c.EFF(23," +52 442 770 6776 "),c.k0s(),c.j41(24,"p",14),c.EFF(25,"Lunes a Viernes: 9:00\u201318:00"),c.k0s(),c.j41(26,"button",15),c.bIt("click",function(){return c.eBV(f),c.Njj(e.abrirUbicacion())}),c.nrm(27,"ion-icon",16),c.EFF(28," C\xd3MO LLEGAR "),c.k0s()(),c.j41(29,"section",17)(30,"h2",18),c.EFF(31,"Redes"),c.k0s(),c.j41(32,"div",19)(33,"a",20),c.nrm(34,"ion-icon",21),c.k0s(),c.j41(35,"a",22),c.nrm(36,"ion-icon",23),c.k0s(),c.j41(37,"a",24),c.nrm(38,"ion-icon",25),c.k0s(),c.j41(39,"a",26),c.nrm(40,"ion-icon",27),c.k0s(),c.j41(41,"a",28),c.nrm(42,"ion-icon",29),c.k0s(),c.j41(43,"a",30),c.nrm(44,"ion-icon",31),c.k0s()()()(),c.j41(45,"div",32),c.EFF(46,"\xa9 2025 Woaw Automotive. Todos los derechos reservados."),c.k0s()()}},dependencies:[h.bv,h.iq,N.MD],styles:['@charset "UTF-8";.woaw-footer[_ngcontent-%COMP%]{background:#f2f2f7;padding:28px 20px 110px;color:#1c1c1e;border-top:1px solid rgba(0,0,0,.08)}.wf-wrap[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:18px}.wf-col[_ngcontent-%COMP%]{background:#fff;padding:18px 20px;border-radius:16px;box-shadow:0 3px 12px #0000000a;border:1px solid rgba(0,0,0,.06)}h2[_ngcontent-%COMP%]{margin:0 0 8px;font-size:18px;font-weight:800;color:#111}p[_ngcontent-%COMP%]{margin:0;color:#6b7280;font-size:14px;line-height:1.45}.legal-mini[_ngcontent-%COMP%]{margin-top:14px;display:flex;gap:10px;flex-wrap:wrap}.legal-mini[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]{color:#007aff;font-weight:600;border-radius:12px;padding:6px 12px;background:#f3f3f7;border:1px solid rgba(0,0,0,.06)}.empresa[_ngcontent-%COMP%]{font-weight:700;margin-bottom:4px;font-size:15px;color:#111}.dato[_ngcontent-%COMP%]{display:inline-block;margin-top:8px;color:#007aff;font-weight:600;font-size:15px;border-bottom:1px dotted rgba(0,0,0,.2)}.btn-primary[_ngcontent-%COMP%]{margin-top:14px;display:inline-flex;align-items:center;gap:8px;padding:12px 18px;background:#ff3b30;color:#fff;border-radius:14px;font-weight:700;border:none;font-size:15px;box-shadow:0 6px 20px #ff3b3040}.social-row[_ngcontent-%COMP%]{margin-top:14px;display:flex;gap:14px;flex-wrap:wrap}.social-row[_ngcontent-%COMP%]   .chip[_ngcontent-%COMP%]{width:42px;height:42px;background:#fff;border-radius:50%;border:1px solid rgba(0,0,0,.08);display:grid;place-items:center;color:#111;font-size:22px;box-shadow:0 2px 6px #00000014}.copy[_ngcontent-%COMP%]{margin-top:20px;font-size:12px;text-align:center;color:#8e8e93}']}),a})()}}]);