"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8908],{8908:(D,f,r)=>{r.r(f),r.d(f,{MisMotosPageModule:()=>S});var g=r(2881),A=r(9417),p=r(7343),M=r(9870),h=r(467),F=r(7051),o=r(1360),O=r(5806),j=r(9557),v=r(2381),y=r(7636),b=r(9847),_=r(4371),P=r(7677),x=r(1969),C=r(8857);const I=["pageContent"];function G(a,c){if(1&a&&o.nrm(0,"app-spinner",12),2&a){const n=o.XpG();o.Y8G("tipo",n.tipo_spinner)("text",n.texto_spinner)("sub_text",n.textoSub_spinner)}}function k(a,c){1&a&&(o.j41(0,"div",13),o.nrm(1,"ion-icon",14),o.j41(2,"p"),o.EFF(3,"No tienes motos agregadas."),o.k0s()())}function R(a,c){if(1&a){const n=o.RV6();o.qex(0),o.j41(1,"app-cartas",15),o.bIt("refrescarAutos",function(i){o.eBV(n);const s=o.XpG();return o.Njj(s.handleRefrescarAutos(i))}),o.k0s(),o.bVm()}if(2&a){const n=c.$implicit,t=o.XpG();o.R7$(),o.Y8G("auto",n)("autosFavoritosIds",t.autosFavoritosIds)("ubicacion","mis_motos")("esMio",t.idsMisMotos.includes(n._id))}}function T(a,c){if(1&a){const n=o.RV6();o.j41(0,"button",23),o.bIt("click",function(){o.eBV(n);const i=o.XpG().$implicit,s=o.XpG(2);return o.Njj(s.cambiarPagina(i))}),o.EFF(1),o.k0s()}if(2&a){const n=o.XpG().$implicit,t=o.XpG(2);o.AVh("activa",t.paginaActual===n),o.R7$(),o.SpI(" ",n," ")}}function $(a,c){1&a&&(o.j41(0,"span",24),o.EFF(1,"\u2026"),o.k0s())}function N(a,c){if(1&a&&(o.qex(0),o.DNE(1,T,2,3,"button",21)(2,$,2,0,"span",22),o.bVm()),2&a){const n=c.$implicit,t=o.XpG(2);o.R7$(),o.Y8G("ngIf",t.esNumero(n)),o.R7$(),o.Y8G("ngIf",!t.esNumero(n))}}function X(a,c){if(1&a){const n=o.RV6();o.j41(0,"div",16)(1,"p",17),o.EFF(2,"M\xe1s"),o.k0s(),o.j41(3,"div",18)(4,"div",19)(5,"button",20),o.bIt("click",function(){o.eBV(n);const i=o.XpG();return o.Njj(i.cambiarPagina(i.paginaActual-1))}),o.EFF(6," \u2039 "),o.k0s(),o.DNE(7,N,3,2,"ng-container",10),o.j41(8,"button",20),o.bIt("click",function(){o.eBV(n);const i=o.XpG();return o.Njj(i.cambiarPagina(i.paginaActual+1))}),o.EFF(9," \u203a "),o.k0s()()()()}if(2&a){const n=o.XpG();o.R7$(5),o.Y8G("disabled",1===n.paginaActual),o.R7$(2),o.Y8G("ngForOf",n.paginasReducidas),o.R7$(),o.Y8G("disabled",n.paginaActual===n.totalPaginas)}}const E=[{path:"",component:(()=>{var a;class c{constructor(t,i,s,e,l,u,d,m){this.generalService=t,this.popoverCtrl=i,this.carsService=s,this.modalCtrl=e,this.router=l,this.route=u,this.motosService=d,this.menuCtrl=m,this.autosAmostrar=[],this.totalMotos=0,this.MisMotos=[],this.idsMisMotos=[],this.autosFiltrados=[],this.autosFavoritosIds=new Set,this.paginaActual=1,this.totalPaginas=1,this.paginas=[],this.motosPaginadas=[],this.filtros=[{label:"$",tipo:"precio"},{label:"Color",tipo:"color"},{label:"Marca",tipo:"marca"}],this.filtrosAplicados={precio:null,anio:null,color:null,marca:null},this.motosFiltradas=[],this.mostrar_spinner=!1,this.tipo_spinner=0,this.texto_spinner="Cargando...",this.textoSub_spinner="Espere un momento"}ngOnInit(){this.menuCtrl.close("menuLateral"),this.generalService.valorGlobal$.subscribe(t=>{this.itemsPorPagina=t,this.misMotos()})}misMotos(){var t=this;return(0,h.A)(function*(){t.mostrar_spinner=!0,t.motosService.misMotosId().subscribe({next:i=>{const s=Array.isArray(null==i?void 0:i.motos)?i.motos:Array.isArray(i)?i:[];t.MisMotos=s,t.motosFiltradas=[...s],t.totalMotos=t.MisMotos.length,t.calcularPaginacion(),t.getCarsFavoritos(),t.misAutosid(),t.mostrar_spinner=!1},error:i=>{var s;t.mostrar_spinner=!1;const e=(null==i||null===(s=i.error)||void 0===s?void 0:s.message)||"Error al obtener tus veh\xedculos.";"No se encontraron veh\xedculos para este usuario"===e?(t.MisMotos=[],t.motosFiltradas=[],t.totalMotos=0,t.calcularPaginacion()):console.warn(e)}})})()}getCarsFavoritos(){this.carsService.getCarsFavoritos().subscribe({next:t=>{const i=t.vehicles.map(s=>s.vehicleId);this.autosFavoritosIds=new Set(i)},error:t=>{}})}misAutosid(){this.carsService.misAutosId().subscribe({next:t=>{this.idsMisMotos=t&&Array.isArray(t.vehicleIds)&&t.vehicleIds.length>0?t.vehicleIds:[]},error:t=>{var i;const s=(null==t||null===(i=t.error)||void 0===i?void 0:i.message)||"Error al obtener tus veh\xedculos.";"No se encontraron veh\xedculos para este usuario"===s?this.idsMisMotos=[]:console.warn(s)}})}regresar(){this.router.navigate(["/home"])}handleRefrescarAutos(t){this.misMotos()}calcularPaginacion(){this.totalPaginas=Math.ceil(this.motosFiltradas.length/this.itemsPorPagina),this.paginas=Array.from({length:this.totalPaginas},(i,s)=>s+1),this.paginaActual=1,this.actualizarMotosPaginadas()}actualizarMotosPaginadas(){const t=(this.paginaActual-1)*this.itemsPorPagina;this.motosPaginadas=this.motosFiltradas.slice(t,t+this.itemsPorPagina)}cambiarPagina(t){this.paginaActual=t,this.actualizarMotosPaginadas(),setTimeout(()=>{var i;null===(i=this.pageContent)||void 0===i||i.scrollToTop(400)},100)}ordenarAutos(t){!this.MisMotos||0===this.MisMotos.length||("precioAsc"===t?this.motosFiltradas.sort((i,s)=>i.precio-s.precio):"precioDesc"===t&&this.motosFiltradas.sort((i,s)=>s.precio-i.precio),this.paginaActual=1,this.calcularPaginacion(),setTimeout(()=>{var i;null===(i=this.pageContent)||void 0===i||i.scrollToTop(400)},100))}mostrarOpciones(t,i){var s=this;return(0,h.A)(function*(){const e=yield s.popoverCtrl.create({component:F.s,event:t,translucent:!0,componentProps:{tipo:i,extra:"motos"}});yield e.present();const{data:l}=yield e.onDidDismiss();s.filtrosAplicados[i]=null===l?null:l,s.aplicarFiltros()})()}aplicarFiltros(){this.motosFiltradas=this.MisMotos.filter(t=>{const i=this.filtrosAplicados.precio,s=this.filtrosAplicados.anio,e=this.filtrosAplicados.color,l=this.filtrosAplicados.marca,u=!i||Array.isArray(i.rango)&&2===i.rango.length&&t.precio>=i.rango[0]&&t.precio<=i.rango[1],d=!s||t.anio===Number(s),m=!e||Array.isArray(t.color)&&t.color.some(z=>z.toLowerCase().trim()===e.label.toLowerCase().trim()),V=!l||t.marca.toLowerCase().trim()===l.label.toLowerCase().trim();return u&&d&&m&&V}),this.totalMotos=this.motosFiltradas.length,this.paginaActual=1,this.calcularPaginacion()}resetearFiltros(){this.filtrosAplicados={precio:null,anio:null,color:null,marca:null},this.aplicarFiltros()}esNumero(t){return"number"==typeof t}get paginasReducidas(){const t=this.totalPaginas,i=this.paginaActual;if(t<=2)return this.paginas;const e=[];e.push(1),i-1>2&&e.push("...");for(let l=Math.max(2,i-1);l<=Math.min(t-1,i+1);l++)e.push(l);return i+1<t-1&&e.push("..."),e.push(t),e}}return(a=c).\u0275fac=function(t){return new(t||a)(o.rXU(O.O),o.rXU(p.IE),o.rXU(j.R),o.rXU(p.W3),o.rXU(v.Ix),o.rXU(v.nX),o.rXU(y.A),o.rXU(p._t))},a.\u0275cmp=o.VBU({type:a,selectors:[["app-mis-motos"]],viewQuery:function(t,i){if(1&t&&o.GBs(I,5),2&t){let s;o.mGM(s=o.lsd())&&(i.pageContent=s.first)}},standalone:!1,decls:14,vars:9,consts:[["pageContent",""],[1,"contenido-ios",3,"fullscreen"],[3,"tipo","text","sub_text",4,"ngIf"],[3,"ordenCambio","totalAutos","titulo"],[1,"contenedor-catalogo-ios"],["size","12","size-md","3"],[3,"mostrarOpciones","limpiarFiltros","filtros","filtrosAplicados"],["size","12","size-md","9"],[1,"catalogo-autos-ios"],["class","mensaje-vacio-ios",4,"ngIf"],[4,"ngFor","ngForOf"],["class","contenedor-paginacion-ios",4,"ngIf"],[3,"tipo","text","sub_text"],[1,"mensaje-vacio-ios"],["name","bicycle-outline"],[3,"refrescarAutos","auto","autosFavoritosIds","ubicacion","esMio"],[1,"contenedor-paginacion-ios"],[1,"titulo-paginacion-ios"],[1,"paginacion-scroll-ios"],[1,"paginacion-ios"],[1,"pagina-ios",3,"click","disabled"],["class","pagina-ios",3,"activa","click",4,"ngIf"],["class","ellipsis-ios",4,"ngIf"],[1,"pagina-ios",3,"click"],[1,"ellipsis-ios"]],template:function(t,i){if(1&t){const s=o.RV6();o.nrm(0,"app-navbar"),o.j41(1,"ion-content",1,0),o.DNE(3,G,1,3,"app-spinner",2),o.j41(4,"app-acomodo",3),o.bIt("ordenCambio",function(l){return o.eBV(s),o.Njj(i.ordenarAutos(l))}),o.k0s(),o.j41(5,"ion-grid",4)(6,"ion-row")(7,"ion-col",5)(8,"app-menu",6),o.bIt("mostrarOpciones",function(l){return o.eBV(s),o.Njj(i.mostrarOpciones(l.event,l.tipo))})("limpiarFiltros",function(){return o.eBV(s),o.Njj(i.resetearFiltros())}),o.k0s()(),o.j41(9,"ion-col",7)(10,"div",8),o.DNE(11,k,4,0,"div",9)(12,R,2,4,"ng-container",10),o.k0s(),o.DNE(13,X,10,3,"div",11),o.k0s()()()()}2&t&&(o.R7$(),o.Y8G("fullscreen",!0),o.R7$(2),o.Y8G("ngIf",i.mostrar_spinner),o.R7$(),o.Y8G("totalAutos",i.totalMotos)("titulo","Motos"),o.R7$(4),o.Y8G("filtros",i.filtros)("filtrosAplicados",i.filtrosAplicados),o.R7$(3),o.Y8G("ngIf",0===(null==i.motosPaginadas?null:i.motosPaginadas.length)),o.R7$(),o.Y8G("ngForOf",i.motosPaginadas),o.R7$(),o.Y8G("ngIf",i.totalPaginas>1))},dependencies:[g.Sq,g.bT,p.hU,p.W9,p.lO,p.iq,p.ln,b._,_.a,P.E,x.Z,C.t],styles:['@charset "UTF-8";.header-ios[_ngcontent-%COMP%]{--background: rgba(249, 249, 249, .94);--border-color: rgba(0, 0, 0, .08);border-bottom:.33px solid var(--border-color);padding-inline:8px;backdrop-filter:blur(18px);-webkit-backdrop-filter:blur(18px)}.btn-back-ios[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;padding:6px 12px;border-radius:999px;background:#0000000d;color:#007aff;font-weight:600;font-size:15px}.btn-back-ios[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px}.btn-back-ios[_ngcontent-%COMP%]:active{background:#0000001a}.logo-ios[_ngcontent-%COMP%]{height:22px;width:auto}.contenido-ios[_ngcontent-%COMP%]{--background: #f2f2f7;font-family:-apple-system,BlinkMacSystemFont,SF Pro Text,sans-serif}.contenedor-catalogo-ios[_ngcontent-%COMP%]{max-width:1100px;margin:0 auto;padding:12px}.catalogo-autos-ios[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:14px}@media (max-width: 768px){.catalogo-autos-ios[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(155px,1fr));gap:10px}}@media (max-width: 540px){.catalogo-autos-ios[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr);gap:8px}}.mensaje-vacio-ios[_ngcontent-%COMP%]{width:100%;min-height:55vh;display:flex;flex-direction:column;align-items:center;justify-content:center;color:#8e8e93;text-align:center}.mensaje-vacio-ios[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:64px;margin-bottom:12px;color:#b3b3b9}.mensaje-vacio-ios[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:15px}.contenedor-paginacion-ios[_ngcontent-%COMP%]{margin-top:22px;text-align:center}.titulo-paginacion-ios[_ngcontent-%COMP%]{margin-bottom:6px;font-size:12px;font-weight:600;text-transform:uppercase;letter-spacing:.12em;color:#6b7280}.paginacion-scroll-ios[_ngcontent-%COMP%]{overflow-x:auto;padding-bottom:4px;scrollbar-width:thin;scrollbar-color:rgba(148,163,184,.9) transparent}.paginacion-scroll-ios[_ngcontent-%COMP%]::-webkit-scrollbar{height:5px}.paginacion-scroll-ios[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#94a3b8e6;border-radius:99px}.paginacion-ios[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:6px;padding:5px 6px;border-radius:999px;background:#fffffff2;-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);box-shadow:0 10px 22px #0000001f,0 0 0 .5px #ffffffe6}.pagina-ios[_ngcontent-%COMP%]{min-width:32px;height:32px;display:flex;align-items:center;justify-content:center;padding:0 10px;border-radius:999px;border:none;background:transparent;font-size:13px;font-weight:600;color:#1c1c1e;transition:background .15s ease,color .15s ease,transform .16s ease,box-shadow .16s ease}.pagina-ios[_ngcontent-%COMP%]:disabled{opacity:.35}.pagina-ios[_ngcontent-%COMP%]:hover:not(:disabled):not(.activa){background:#94a3b82e;transform:translateY(-1px)}.pagina-ios.activa[_ngcontent-%COMP%]{background:#ff3b30;color:#fff;box-shadow:0 8px 18px #ff3b308c;transform:translateY(-1px)}.ellipsis-ios[_ngcontent-%COMP%]{font-size:14px;padding:0 6px;color:#999}']}),c})()}];let Y=(()=>{var a;class c{}return(a=c).\u0275fac=function(t){return new(t||a)},a.\u0275mod=o.$C({type:a}),a.\u0275inj=o.G2t({imports:[M.iI.forChild(E),M.iI]}),c})();var w=r(5473);let S=(()=>{var a;class c{}return(a=c).\u0275fac=function(t){return new(t||a)},a.\u0275mod=o.$C({type:a}),a.\u0275inj=o.G2t({imports:[g.MD,A.YN,p.bv,Y,b._,_.a,P.E,w.n,x.Z,C.t]}),c})()}}]);